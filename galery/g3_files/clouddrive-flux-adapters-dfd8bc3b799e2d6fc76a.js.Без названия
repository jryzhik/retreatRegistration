"use strict";(globalThis.webpackChunk_amzn_amazon_photos_react=globalThis.webpackChunk_amzn_amazon_photos_react||[]).push([[735],{51158:(e,t,i)=>{i.d(t,{A:()=>h});var o=i(24713),r=i.n(o),n=i(59104),s=i.n(n),a=i(7350),l=i.n(a),c=i(98366),d=i(35994),p=i(21764);const h=class AbstractCollection{constructor(e){this.eventEmitter=new c.A,this.dataCache=[],this.throttledRefresh=l()((()=>this.refresh()),5e3),this.initialize(e)}toJSON(){return{hidden:"toJSON overriden to prevent Redux DevTools from crashing"}}fail(){}getPageIndex(e){return Math.floor(e/this.limit)}atIndex(e){return this.dataCache&&s()(e,0,this.dataCache.length)?this.dataCache[e]?this.dataCache[e]:void 0:null}getTotalPageCount(){return this.count?Math.ceil(this.count/this.limit):0}initialize(){throw"AbstractCollection.initialize not implemented"}reset(){throw"AbstractCollection.reset not implemented"}deleteModels(){throw"AbstractCollection.deleteModels was not implemented"}getPage(){throw"AbstractCollection.getPage not implemented"}getByIndexRange(){throw"AbstractCollection.getByIndexRange not implemented"}listen(e,t){this.eventEmitter.addListener("change",e,t)}unListen(e,t){this.eventEmitter.removeListener("change",e,t)}emitChange(e){this.eventEmitter.emit("change",e)}refresh(){d.A.emit("uncache"),this.initialize(this.initOptions)}getById(){throw"AbstractCollection.getById not implemented. Implementations must return a promise."}indexOf(e){var{nodeId:t}=(0,p.A)(e);return r()(this.dataCache,{id:t})}}},44418:(e,t,i)=>{i.d(t,{A:()=>AggregationCollection});var o=i(39754),r=i.n(o),n=i(56449),s=i.n(n),a=i(55378),l=i.n(a),c=i(87612),d=i.n(c),p=i(58156),h=i.n(p),u=i(97200),m=i.n(u),g=i(32629),f=i.n(g),v=i(62193),y=i.n(v),b=i(74692),P=i(55488),A=i(90801),C=["timeMonth","timeYear","timeDay"],w=" AND ";class AggregationCollection extends A.A{initialize(){return this._needsAggregations=!0,super.initialize(...arguments)}fetchContent(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="day"===e.groupByForTime;return super.fetchContent(e).done((e=>{!y()(e.aggregations)&&this._needsAggregations&&(this._needsAggregations=!1,this.setAggregations(e.aggregations,{isGroupedByDay:t}))}))}getAggregationsWithoutFilter(e){var t=(0,b.Deferred)(),{operation:i}=this.options,o=this._getServiceOptions({limit:1});return o.filters=this.removeFilter(o.filters,e)||void 0,i(o).done((e=>t.resolve(e.aggregations))).fail(t.reject),t.promise()}setAggregations(e){var t=this,{isGroupedByDay:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=f()(e);var{aggregations:o={}}=this,{lastFilter:r}=this.options,n=m()();this._lastFilterChecking=n;var save=()=>{this.aggregations=e,this.emitChange()},s=o[r],a=h()(P.Bj[r],"bufferResponse"),l=r;"time"===r&&(l=C,i&&!this._timeAggregationIncludesDays&&(s||(a=!1,this._timeAggregationIncludesDays=!0)),!i&&this._timeAggregationIncludesDays&&(a=!0,s=!1,this._timeAggregationIncludesDays=!1)),a&&!s?this.getAggregationsWithoutFilter(l).done((function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t._lastFilterChecking===n&&(e[r]=i[r],save())})).fail((()=>{this._lastFilterChecking===n&&save()})):(a&&s&&(e[r]="time"===r&&i?this._mergeDaysIntoTimeAggregation(s,e[r]):s),save())}_mergeDaysIntoTimeAggregation(e,t){if(!t||!t.length||!e)return e;var i=t[0].match.substring(0,7),o=-1,r=d()(e,((e,t)=>0!==e.match.indexOf(i)||(-1===o&&(o=t),!1)));return-1!==o?r=r.slice(0,o).concat(t).concat(r.slice(o)):0===e.length&&(r=t),r}splitFilters(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split(")"+w);return l()(e,((t,i)=>(i!==e.length-1&&(t+=")"),t)))}removeFilter(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;s()(t)||(t=[t]);var i=l()(this.splitFilters(e),(e=>{var[t,i]=e.split(":");return{key:t,value:i}})),o=d()(i,(e=>-1===t.indexOf(e.key))),r=l()(o,(e=>"".concat(e.key,":").concat(e.value)));return-1!==t.indexOf("type")&&r.push("type:(PHOTOS OR VIDEOS)"),r.join(w)}getSelectedFilters(){return this.parseFilters(this.options.filters)}parseFilters(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t={};return r()(this.splitFilters(e),(e=>{var[i,o]=e.split(":");i&&o&&(o=o.replace(/\(|\)/g,"").replace(/ OR | AND /g,"|||").split("|||"),t[i]=o)})),t}}},60788:(e,t,i)=>{i.d(t,{A:()=>d});var o=i(7309),r=i.n(o),n=i(97200),s=i.n(n),a=i(74692),l=i.n(a),c=i(90801);class CountlessPaginatedCollection extends c.A{initialize(){return this.dataCache=[],this.complete=!1,super.initialize(...arguments)}refresh(){var{dataCache:e,previousToken:t,_pendingPreviousToken:i}=this,o=this.pages[0];if(o&&"resolved"===o.dfd.state()&&!i){if(!this.previousToken)return super.refresh(...arguments);var iterator=t=>{var i=this._getServiceOptions({previousToken:t});this._pendingPreviousToken=!0,super.fetchContent(i).done((i=>{var{data:o,previousToken:r}=i;if(o.length){for(var n=o.length-1;n>=0;n--)e.unshift(o[n]);r?iterator(r):(super.fetchContent(this._getServiceOptions({limit:1})).done((e=>{var{previousToken:t}=e;this.previousToken=t,this._pendingPreviousToken=!1})),this.uid=s()(),this.emitChange())}else this.previousToken=t,this._pendingPreviousToken=!1})).fail((()=>{this.previousToken=t,this._pendingPreviousToken=!1}))};iterator(t)}}deleteModels(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],{dataCache:t}=this,i=[],o=0;o<e.length;o++){var r=this.indexOf(e[o].id);-1!==r&&(t.splice(r,1),i.push(e[o]))}i.length&&this.eventEmitter.emit("change",{action:"removeModelDone",models:i})}get count(){var{dataCache:e,complete:t,limit:i}=this;return t||0===e.length?e.length:e.length+i}set count(e){return e}fetchContent(e){for(var{dataCache:t}=this,i=arguments.length,o=new Array(i>1?i-1:0),r=1;r<i;r++)o[r-1]=arguments[r];return super.fetchContent(e,...o).done((i=>{for(var{data:o}=i,r=0;r<o.length;r++)t.push(i.data[r]);i.nextToken||(this.complete=!0),e.nextToken||e.previousToken||(this.previousToken=i.previousToken)}))}getByIndexRange(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=l().Deferred(),{dataCache:r,complete:n,pages:s}=this;if(r.length>=t+1||n){var a=r.slice(e,t+1);return i.synchronous?a:(o.resolve(a),o.promise())}var iterator=i=>{var{complete:n}=this;n||r.length>=t+1?o.resolve(r.slice(e,t+1)):this.getPage(i).done((()=>iterator(i+1))).fail(o.reject)};if(iterator(s.length?s.length-1:0),i.synchronous){for(var c=new Array(t-e+1),d=r.slice(e,t),p=0;p<d.length;p++)c[p]=d[p];return c}return o.promise()}indexOf(e){var{dataCache:t}=this,i=r()(t,{id:e});return t.indexOf(i)}atIndex(e){var{dataCache:t}=this;return t[e]}throwUnsupportedError(e){throw new Error("".concat(e," not supported by CountlessPaginatedCollection"))}get totalPages(){return this.throwUnsupportedError("totalPages")}simulatePageContents(){return this.throwUnsupportedError("simulatePageContents")}getById(){return this.throwUnsupportedError("getById")}isContentPending(){return this.throwUnsupportedError("isContentPending")}isPreviousPageLoaded(){return this.throwUnsupportedError("isPreviousPageLoaded")}getNextUnloadedPage(){return this.throwUnsupportedError("getNextUnloadedPage")}getPageIndex(){return this.throwUnsupportedError("getPageIndex")}getTotalPageCount(){return this.throwUnsupportedError("getTotalPageCount")}}const d=CountlessPaginatedCollection},85026:(e,t,i)=>{i.d(t,{A:()=>S});var o=i(43346),r=i.n(o),n=i(62193),s=i.n(n),a=i(44418),l=i(47091),c=i.n(l),d=i(62216),p=i.n(d),h=i(32629),u=i.n(h),m=i(7309),g=i.n(m),f=i(39754),v=i.n(f),y=i(44383),b=i.n(y),P=i(95093),A=i.n(P),C=i(73725),w=i(18742),_=i(78439),O="YYYY-MM-DD",getNoDateDate=()=>w.A.getProperty("noDateDate"),T={getHistogram:function getHistogram(){var e=b()(this,this.queryOptions);_.A.getHistogram(r()({bucket:this.histogramBucket,groupBy:this.histogramGroup},e)).done((e=>{this.histogram={},v()(e.countMap,((e,t)=>{this.histogram[A().utc(t).format(O)]=e})),this.emitChange({histogram:this.histogram})}))},getNodeBucketDate:function getNodeBucketDate(e){var t,i;switch(this.histogramGroup){case"contentDate":return e.contentDate()||getNoDateDate();case"dateAddedToGroup":return t=this.initOptions?this.initOptions.groupId:this.groupId,(i=g()(e.groupPermissions,{groupId:t}))?i.lastModifiedTime:null;default:return e.getCreatedDate()}},deleteFromPageLayoutHistogram:function deleteFromPageLayoutHistogram(e){var t,i,o,r,n=this.getNodeBucketDate(e),s=n.slice(0,7),a=n.slice(0,10),l=!1;for(o in this.pageLayoutHistogram)if(l||o===s)for(r in(t=this.pageLayoutHistogram[o]).count--,t.sectionEnd--,t.sectionStart--,t.knownDays)i=t.knownDays[r],l?(i.end--,i.start--):r===a&&(l=!0,i.end--,i.end<i.start&&delete t.knownDays[r])},pageLayoutHistogramDayCounts:function pageLayoutHistogramDayCounts(){var e,t,i,o,r=[];for(i in this.pageLayoutHistogram)for(o in(e=this.pageLayoutHistogram[i]).knownDays)t=e.knownDays[o],r[o]=t.end-t.start+1;return r},generateHistogram:function generateHistogram(e,t){var i=t.aggregations&&t.aggregations.time?t.aggregations.time:void 0;i&&this.loadSkHistogram&&!this.pageLayoutHistogram&&("day"===this.groupByForTime?(this.pageLayoutHistogram=this._generateHistogramFromYearMonthDayResponse(u()(i).reverse()),this.generatePageLayoutHistogram()):(this.pageLayoutHistogram=this._generateHistogramFromYearMonthResponse(u()(i).reverse()),this.updateHistogram(e,t)))},_generateHistogramFromYearMonthResponse:function _generateHistogramFromYearMonthResponse(e){var t=0,i=0,o={},r=getNoDateDate().substr(0,4),n=getNoDateDate().substr(0,7),s={count:0};return v()(e,(e=>{i+=e.count,e.match.indexOf(r)>-1?(s.count+=e.count,p()(s.sectionStart)&&(s.sectionStart=t)):(o[e.match]={count:e.count,remaining:e.count,sectionStart:t,sectionEnd:t+e.count-1,knownDays:{}},t=i)})),s.count&&(o[n]={count:s.count,remaining:s.count,sectionStart:s.sectionStart,sectionEnd:s.sectionStart+s.count-1,knownDays:{}}),o},_generateHistogramFromYearMonthDayResponse:function _generateHistogramFromYearMonthDayResponse(e){var t,i=0,o=0,r={};return v()(e,((n,s)=>{o+=n.count,0===s&&(t=n.match.substring(0,7),r[t]={remaining:0,sectionStart:0,knownDays:{}}),r[t].knownDays[n.match]={start:i,end:i+n.count-1,isDone:!0},s===e.length-1&&(r[t].count=o,r[t].sectionEnd=o-1),i=o})),r},updateHistogram:function updateHistogram(e,t){if(this.loadSkHistogram&&this.pageLayoutHistogram&&c()(this.pageLayoutHistogram)&&"day"!==this.groupByForTime&&!this.parsedResponseForPageIndex[e]){this.parsedResponseForPageIndex[e]=!0,t=t||{},this.sortedBy=t.sortedBy;var i=t.data||[],o=this.pageLayoutHistogram,r=e*this.limit,n={},s="contentDate"===this.histogramGroup;v()(i,(e=>{var t,i,a,l=this.getNodeBucketDate(e);if(!l&&s&&(l=getNoDateDate()),l){if(t=l.substring(0,7),i=l.substring(0,10),!o[t])return void C.A.error("PaginatedCollection.updateHistogram: Missing histogram data for "+t);n[i]=!0,(a=o[t].knownDays[i])?(r<a.start&&(a.start=r),r>a.end&&(a.end=r)):o[t].knownDays[i]={start:r,end:r,isDone:!1},o[t].remaining-=1}r++})),v()(Object.keys(n).sort().reverse(),(e=>{var t=e.substring(0,7);if(o[t]){var i,r,n,s,a=o[t],l=a.knownDays[e],c=Object.keys(a.knownDays).sort().reverse(),d=c.indexOf(e);(a.sectionStart===l.start||(n=d>0?a.knownDays[c[d-1]]:void 0)&&n.end+1===l.start)&&(i=!0),(a.sectionEnd===l.end||(s=d<c.length-1?a.knownDays[c[d+1]]:void 0)&&s.start-1===l.end)&&(r=!0),i&&r&&(l.isDone=!0)}else C.A.error("PaginatedCollection.updateHistogram: Missing histogram data for "+t)})),this.pageLayoutHistogram=o,this.generatePageLayoutHistogram()}},generatePageLayoutHistogram:function generatePageLayoutHistogram(){if(this.loadSkHistogram&&this.pageLayoutHistogram){var e,t,i,o=this.pageLayoutHistogram,r=Object.keys(o).sort().reverse(),n={};for(var s in r){var a=r[s],l=o[a],c=Object.keys(o[a].knownDays).sort().reverse(),d=l.knownDays[c[0]],p=0;0!==c.length?(d&&d.start-l.sectionStart>0&&(e=A()(c[0]).add(1,"days"),t=d.start-l.sectionStart,i=n[e.format(O)]||0,n[e.format(O)]=i+t,p+=t),v()(c,((e,t)=>{var i=l.knownDays[e],o=l.knownDays[c[t-1]],r=i.end-i.start+1;if(n[e]=r,p+=r,o&&i.start-o.end>1){var s=A()(e).add(1,"days"),a=n[s.format(O)]||0,d=i.start-o.end-1,h=a+d;n[s.format(O)]=h,p+=d}})),p<l.count&&(e=A()(c[c.length-1]).subtract(1,"days"),t=l.count-p,n[e.format(O)]=t)):n[A()(a+"-01").format(O)]=l.count}this.filledHistogram=n,this.emitChange({histogram:n})}}};const E=T;class HistogramCollection extends a.A{initialize(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{groupByForTime:t,histogramBucket:i="day",sort:o,histogramGroup:r}=e;this.groupByForTime=t,this.loadSkHistogram=!0,this.parsedResponseForPageIndex={},this.histogram=void 0,this.pageLayoutHistogram=void 0,this.histogramBucket=i,this.histogramGroup=r||(o&&-1!==o.search(/contentDate/i)?"contentDate":"createdDate"),super.initialize(...arguments)}fetchContent(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.fetchContent(...arguments).done((t=>{t.aggregations&&!s()(t.aggregations)?this.generateHistogram(e.pageIndex,t):this.updateHistogram(e.pageIndex,t)}))}}r()(HistogramCollection.prototype,E);const S=HistogramCollection},39138:(e,t,i)=>{i.d(t,{A:()=>y});var o=i(7309),r=i.n(o),n=i(64112),s=i.n(n),a=i(48081),l=i.n(a),c=i(38970),d=i.n(c),p=i(97200),h=i.n(p),u=i(56449),m=i.n(u),g=i(74692),f=i(51158),v=i(21764);class PopulatedCollection extends f.A{initialize(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!m()(e))throw new Error("PopulatedCollection initialized without a list array");this.dataCache=e,this.limit=60,this.emitChange(),this.uid=h()()}get count(){return this.dataCache.length}reset(e){this.initialize(Array.isArray(e)?e:[])}deleteModels(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=d()(e,"id");this.dataCache=l()(this.dataCache,(e=>Boolean(t[e.id]))),this.emitChange({action:"removeModelDone",models:e})}getByIndexRange(e,t,i){var o;if(i=i||{synchronous:!1},-1===t&&(t=this.dataCache.length-1),e>t&&([e,t]=[t,e]),o=this.dataCache.slice(e,t+1),i.synchronous)return o;var r=(0,g.Deferred)();return s()((()=>r.resolve(o))),r.promise()}getPage(e,t){t=t||{};var i=e*this.limit,o=i+this.limit,r=this.dataCache.slice(i,o+1),n=(0,g.Deferred)().resolve(r);return t.synchronous?r:n}getById(e){var{nodeId:t}=(0,v.A)(e),i=r()(this.dataCache,{id:t});return(0,g.Deferred)().resolve(i).promise()}}const y=PopulatedCollection},90801:(e,t,i)=>{i.d(t,{A:()=>TokenPaginatedCollection});var o=i(68090),r=i.n(o),n=i(42426),s=i.n(n),a=i(24713),l=i.n(a),c=i(50014),d=i.n(c),p=i(87612),h=i.n(p),u=i(55378),m=i.n(u),g=i(23181),f=i.n(g),v=i(32629),y=i.n(v),b=i(39754),P=i.n(b),A=i(2404),C=i.n(A),w=i(1882),_=i.n(w),O=i(97200),T=i.n(O),E=i(74692),S=i.n(E),I=i(51158),x=i(21764),k=i(43346),N=i.n(k),D=i(84684),j=i.n(D),L=i(35994),M=i(69944),R=i(21572),z=function SelectRange(e){this.init(j()(e,{batchSize:1,activeLimit:1,priority:1,groupName:"selectRange"})),j()(this,{message:(0,R.A)("amazon-photos-select-all-in-progress",[this.totalItemCount],this.totalItemCount)})};z.prototype=new M.A,N()(z.prototype,{success:function success(){this.showToast&&!this.cancelled&&L.A.emit("showToast",{metricEventTag:"SelectRangeSuccess",className:"success",message:(0,R.A)("amazon-photos-select-all-success",[this.totalItemCount],this.totalItemCount)})},failure:function failure(){this.showToast&&L.A.emit("showToast",{metricEventTag:"SelectRangeFail",className:"fail",message:(0,R.A)("amazon-photos-select-all-error",[this.failedItems.length],this.failedItems.length)})},task:function task(e){return this.getPageCallback(e[0])}});const F=z;function ownKeys(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(i),!0).forEach((function(t){_defineProperty(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ownKeys(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function _defineProperty(e,t,i){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var B="pending";class TokenPaginatedCollection extends I.A{initialize(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.pages=[],this.count=void 0,this.initOptions=e,this.uid=T()(),e=_objectSpread({useNextToken:!0,getFirstPageOnInit:!0,limit:200,requiresStartToken:!1},e),this.options=e,this.limit=e.limit,!_()(e.operation))throw"Operation must be a function";e.getFirstPageOnInit&&this.getPage(0)}reset(e){C()(e,this.initOptions)||(this.initialize(e),this.emitChange())}refresh(){var{count:e}=this;super.refresh(...arguments),this.count=e,this.getPage(0)}deleteModels(e){var t=[];if(P()(e,(e=>{var i=this.indexOf(e.id);i>-1&&t.push({index:i,model:e})})),t.length){for(var i,o=0;o<t.length;o++){var r=this.getPageIndex(t[o].index);(void 0===i||r<i)&&(i=r)}if(this.totalPages<=i)return;for(var n=i;n<this.totalPages;n++)delete this.pages[n];this.getPage(i),this.uid=T()(),this.eventEmitter.emit("change",{action:"removeModelDone",models:t})}}_getServiceOptions(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{filterQuery:t}=this.options,i=_objectSpread(_objectSpread({},this.options),e);return t&&(i=t(i)),i}getPage(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{limit:i,useNextToken:o,requiresStartToken:r}=this.options,{pages:n}=this,s=n[e];if(s)return t.synchronous?s.contents?y()(s.contents):this.simulatePageContents(e):s.dfd;var a=S().Deferred(),l=this._getServiceOptions({pageIndex:e});n[e]={dfd:a.promise()};var getReturn=()=>t.synchronous?this.simulatePageContents(e):a.promise(),onFinish=t=>{n===this.pages&&(this.count=t.count,this.pages[e].contents=t.data,this.pages[e].nextToken=t.nextToken,a.resolve(t.data),this.emitChange())},onFail=()=>{n===this.pages&&(delete this.pages[e],a.reject())};if(o){var c=r?"startToken":"nextToken";if(0===e)r&&(l[c]="");else{var d=e-1,p=this.pages[d];if(!p||!p.nextToken){var h=_objectSpread(_objectSpread({},t),{},{synchronous:!1});return this.getPage(d,h).then((()=>{if(n===this.pages){if(!(p=this.pages[d])||!p.nextToken)throw"Unable to get nextToken";return l[c]=p.nextToken,this.fetchContent(l)}})).done(onFinish).fail(onFail),getReturn()}l[c]=p.nextToken}}else l.offset=i*e;return this.fetchContent(l).done(onFinish).fail(onFail),getReturn()}fetchContent(e){var t=S().Deferred(),{operation:i,parseResponse:o}=this.options;return i(e).done((e=>{o&&(e=o(e)),t.resolve(e)})).fail(t.reject),t.promise()}get totalPages(){var{count:e}=this,{limit:t}=this.options;return void 0===e?null:Math.ceil(e/t)}simulatePageContents(e){var{count:t}=this,{limit:i}=this.options,o=this.totalPages;return null===o?[]:new Array(e===o-1?t%(i*o):i)}_fetchById(e){var{operation:t}=this.options;return t(this._getServiceOptions({limit:1,id:e}))}getById(e){var{nodeId:t}=(0,x.A)(e),{parseResponse:i}=this.options,o=S().Deferred(),getCached=()=>{var t=this.indexOf(e);if(-1!==t)return this.atIndex(t)},recursivelyGetPages=e=>{var i=this.totalPages,r=5;null!==i&&i<5&&(r=i);var n=this.indexOf(t);-1===n?e>=r?o.reject():this.getPage(e).done((()=>{var t=getCached();t?o.resolve(t):recursivelyGetPages(e+1)})).fail(o.reject):o.resolve(this.atIndex(n))},r=getCached();return r?o.resolve(r):this._fetchById(e).done((e=>{i&&(e=i(e)),o.resolve(e)})).fail((()=>recursivelyGetPages(0))),o.promise()}getByIndexRange(e,t){var i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e<0&&(e=0),t<0&&Number.isFinite(this.count)&&(t=this.count-Math.abs(t)),e>t&&([e,t]=[t,e]);var{synchronous:r,isSelectionAction:n=!1,selectOperationMetric:s}=o,{limit:a}=this.options,{count:l}=this;if(void 0!==l&&(t=Math.min(t,l-1)),0===l)return r?[]:S().Deferred().resolve([]).promise();var c=Math.floor(e/a),p=Math.floor(t/a),u=f()(c,p+1),g=m()(u,(e=>this.getPage(e)));if(r){for(var v=[],y=function _loop(){var o=u[b]*a,n=i.getPage(u[b],{synchronous:r}),s=h()(n,((i,r)=>{var n=r+o;return n>=e&&n<=t}));v=v.concat(s)},b=0;b<u.length;b++)y();var P=d()(v,"id");return this.selectRangeOperation&&(this.selectRangeOperation.totalItemCount=P.length),v}var A=t-e+1;n&&Number.isFinite(A)&&A>a&&this.isContentPending()&&(this.selectRangeOperation=new F({totalItemCount:A,skipBizMetric:!0,metricName:s,items:u,getPageCallback:this.getPage.bind(this),showToast:!0,cdsDelay:0}).start());var C=S().Deferred();return S().when.apply(S(),g).always((()=>C.resolve(this.getByIndexRange(e,t,{synchronous:!0})))),C}getPageIndexById(e){var{nodeId:t}=(0,x.A)(e);return this.getPageIndex(this.indexOf(t))}indexOf(e){for(var{nodeId:t}=(0,x.A)(e),{pages:i,limit:o}=this,r=-1,n=0;n<this.pages.length;n++)if(i[n]&&i[n].contents){var s=l()(i[n].contents,{id:t});if(-1!==s){r=s+n*o;break}}return r}atIndex(e){var t=this.getPageIndex(e);return((this.pages[t]||{}).contents||[])[e-t*this.limit]}isContentPending(){return s()(this.pages,(e=>e.dfd.state()===B))}isPreviousPageLoaded(e){var t=this.getPageIndex(e);if(0!==t){var i=this.pages[t-1];return Boolean(i&&i.dfd&&i.dfd.state()!==B)}}getNextUnloadedPage(){for(var{pages:e}=this,t=this.totalPages||0,i=0;i<t;i++){var o=e[i];if(!o||!o.dfd)return this.getPage(i);if(o.dfd.state()===B)return o.dfd}return r()(e).dfd}}},81774:(e,t,i)=>{i.d(t,{A:()=>ShiftSelectDecorator});var o=i(62193),r=i.n(o),n=i(96540),s=i(35994),a=i(14324),l=i(21572),c=i(74692),d=i.n(c);function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},_extends.apply(this,arguments)}function _defineProperty(e,t,i){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var p=60;function ShiftSelectDecorator(e){var t;return t=class extends n.Component{constructor(){super(...arguments),_defineProperty(this,"onSelectShiftClick",(e=>{var t,i,o,n=!0,c=a.A.getProperty("selection"),h=a.A.getProperty("lastSelectedId"),u=a.A.getProperty("maxSelectAllCount");return!h||a.A.data.selectionOptions.singleSelect?d().Deferred().reject([]).promise():(i=this.props.collection.indexOf(h),o=this.props.collection.indexOf(e.id),-1===i||-1===o?d().Deferred().reject([]).promise():(o<i?([i,o]=[o,i],o-=1):i+=1,t=o-i+1,c.getSize()+t>u&&(s.A.emit("showToast",{message:(0,l.A)("amazon-photos-select-range-limit-body",u),className:"error"}),o=i+(t=u-c.getSize())-1),0===t?d().Deferred().resolve([]).promise():(t<=p&&(n=!1),this.props.collection.getByIndexRange(i,o,{showToast:n}).done((e=>{r()(e)||s.A.emit("selectItem",e)})))))}))}render(){return n.createElement(e,_extends({},this.props,this.state,{onSelectShiftClick:this.onSelectShiftClick}))}},_defineProperty(t,"displayName","ShiftSelect(".concat(e.displayName,")")),t}},1683:(e,t,i)=>{i.d(t,{A:()=>h});var o=i(43346),r=i.n(o),n=i(97463),s=i(18742),a=i(84645),l={CUSTOMER_ID:function CUSTOMER_ID(){return n.A.getProperty("customerId")},SESSION_ID:function SESSION_ID(){return this.data.sessionId||n.A.getProperty("sessionId")},CLIENT_ID:function CLIENT_ID(){return s.A.getProperty("client").clientId},CLIENT_TAG:function CLIENT_TAG(){return s.A.getProperty("client").clientName},DEVICE_PLATFORM:function DEVICE_PLATFORM(){return s.A.getProperty("client").devicePlatform},DEVICE_VERSION:function DEVICE_VERSION(){return s.A.getProperty("client").deviceVersion},DEVICE_MODEL:function DEVICE_MODEL(){return s.A.getProperty("client").deviceModel},DEVICE_SERIAL_NUMBER:function DEVICE_SERIAL_NUMBER(){return s.A.getProperty("client").deviceSerial}};class BizMetric extends a.A{get config(){return{propertyGetters:r()({},super.config.propertyGetters,l)}}}const c=BizMetric;var d=i(35994),p=i(34128);class BizMetrics extends p.Ay{get config(){return{BizMetric:c,foresterConfig:s.A.getProperty("metrics.forester",{}),sushiConfig:s.A.getProperty("metrics.sushi",{})}}init(){return super.init(...arguments),d.A.listen("flushBizMetrics",(()=>this.sendDataAsAjax()),this),d.A.listen("bmSessionInactive",(()=>this.onInactivityTimeout()),this),d.A.listen("bmSessionExpire",(()=>this.onMaxSessionTimeout()),this),this}}const h=(new BizMetrics).init()},6687:(e,t,i)=>{i.d(t,{A:()=>P});var o=i(95950),r=i.n(o),n=i(90179),s=i.n(n),a=i(2404),l=i.n(a),c=i(38221),d=i.n(c),p=i(96540),h=i(5556),u=i.n(h),m=i(42749),g=i(61738),f=i(73725),v=i(13489);function _defineProperty(e,t,i){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var y=m.A.types,b=f.A.createLogger("Metrics","info");const P=function ImageLoadBeaconDecorator(e){class ImageLoadBeacon extends p.Component{constructor(){super(...arguments),_defineProperty(this,"reset",(()=>{this.sentATF=this.sentCompleted=!1,this.imageTimings=new Map})),_defineProperty(this,"onImageStatusChange",((e,t,i,o,r)=>{if(!this.sentCompleted&&this.props.ilbConfig.isActive)if("imageStart"===e)this.imageTimings.set(t,{start:o,domEl:i});else if("imageCancel"===e||"imageError"===e)this.imageTimings.delete(t),this.countLoadedImagesDebounced();else if("imageLoaded"===e){var n=this.imageTimings.get(t);n&&(n.domEl=i,n.end=o,n.fromCache=r),this.countLoadedImagesDebounced()}})),_defineProperty(this,"countLoadedImages",(()=>{var e=this.props.ilbConfig,t=g.A.getProperty("width"),i=g.A.getProperty("height"),o=g.A.getProperty("scrollPosition"),r=0,n=0,s=0,a=0,l=0,c=0,d=0,p=0;if(!this.isUnmounting&&!this.sentCompleted&&e.isActive)if(this.imageTimings.size){for(var[h,{domEl:u,start:m,end:f,fromCache:P}]of this.imageTimings)if(u){if(!this.sentATF){var A=u.getBoundingClientRect();A.top+o<=i&&A.left<t&&A.right>0&&(m&&r++,f&&(n++,s=Math.max(s,f)))}m&&l++,f&&c++,m&&f&&(a=Math.max(a,f),P||(d+=f-m,p++))}else b("Missing domEl for %s",h);if(this.sentATF?b("".concat(this.name," Total loading ").concat(l,", total done: ").concat(c)):b("".concat(this.name," ATF expecting: ").concat(r,", ATF done: ").concat(n,". Total loading: ").concat(l,", total done: ").concat(c)),this.sentATF||r!==n||(this.broadcast(y.ATF,s),this.sentATF=!0),l===c){var C=c-p;b("".concat(this.name," all images loaded, total uncached load time ").concat(p," ms, cached: ").concat(C)),this.broadcast(y.COMPLETED,a),this.sentCompleted=!0,this.imageTimings.clear(),p>0&&v.A.log({name:"UncachedImageLoadTime",type:"TIMER",value:d,samples:p}),C>0&&v.A.log({name:"ImageLoadCacheCount",type:"COUNTER",value:C})}}else b("".concat(this.name," no image nodes, probably because page reset to 0 items due to query change."))})),_defineProperty(this,"broadcast",((e,t)=>{this.context.beaconListener({status:e,timestamp:t})}))}getChildContext(){return{imageStatusListener:this.onImageStatusChange}}UNSAFE_componentWillMount(){var{name:e,isActive:t,changeHash:i}=this.props.ilbConfig;this.name=e,b("".concat(this.name," mounting, isActive: ").concat(t,", changeHash: "),i),this.reset(),this.isUnmounting=!1,this.countLoadedImagesDebounced=d()(this.countLoadedImages,100)}componentDidUpdate(e){var t=e.ilbConfig,i=this.props.ilbConfig;!i.isActive||t.isActive&&l()(i.changeHash,t.changeHash)||(b("".concat(this.name," activating")),this.reset(),this.countLoadedImagesDebounced())}componentWillUnmount(){this.isUnmounting=!0}render(){return p.createElement(e,s()(this.props,r()(ImageLoadBeacon.propTypes)))}}return _defineProperty(ImageLoadBeacon,"displayName","ImageLoadBeacon(".concat(e.displayName,")")),_defineProperty(ImageLoadBeacon,"propTypes",{ilbConfig:u().shape({isActive:u().bool.isRequired,name:u().string.isRequired,changeHash:u().any})}),_defineProperty(ImageLoadBeacon,"contextTypes",{beaconListener:u().func.isRequired}),_defineProperty(ImageLoadBeacon,"childContextTypes",{imageStatusListener:u().func}),ImageLoadBeacon}},49907:(e,t,i)=>{i.d(t,{A:()=>p});var o=i(64112),r=i.n(o),n=i(1882),s=i.n(n),a=i(96540),l=i(5556),c=i.n(l),d=i(42749);function _defineProperty(e,t,i){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class PageMetricBeacon extends a.Component{constructor(){super(...arguments),_defineProperty(this,"broadcast",(()=>{this.props.status===d.A.types.COMPLETED||this.props.status===d.A.types.EMPTY?r()((()=>{this.context.beaconListener({status:this.props.status,timestamp:Date.now(),count:this.props.count})})):this.context.beaconListener({status:this.props.status,timestamp:Date.now(),count:this.props.count})}))}componentDidMount(){s()(this.context.beaconListener)||(this.broadcast=function(){}),this.broadcast()}componentDidUpdate(e){this.props.status!==e.status&&this.broadcast()}render(){return!1}}_defineProperty(PageMetricBeacon,"propTypes",{status:c().oneOf(d.A.beaconTypes),count:c().number}),_defineProperty(PageMetricBeacon,"contextTypes",{beaconListener:c().func});const p=PageMetricBeacon},47589:(e,t,i)=>{i.d(t,{A:()=>w});var o=i(39754),r=i.n(o),n=i(2404),s=i.n(n),a=i(61448),l=i.n(a),c=i(7309),d=i.n(c),p=i(96540),h=i(5556),u=i.n(h),m=i(35994),g=i(71086),f=i(73725),v=i(1683),y=i(42749);function _defineProperty(e,t,i){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var{types:b,timingTypes:P}=y.A,A=f.A.createLogger("Metrics","info"),C=function _validateConfig(e){var t;d()({pageType:"string",subPageType:"string",clickTime:"number",query:"object",pageContext:"string"},(function(i,o){var r=e[o];if(!l()(e,o)||typeof r!==i||!r)return t=o,!0})),t&&A.warn("PageMetricMonitor: Missing or invalid type for config '".concat(t,"'"))};const w=function PageMetricMonitorDecorator(e){class PageMetricMonitor extends p.Component{constructor(){super(...arguments),_defineProperty(this,"onRouteChanged",(e=>{var t=this.routeCfg,i=e.metrics;e.pathChanged&&!s()(i,t)&&(A("==== onRouteChanged context: %s, clickTime: %d",i.pageContext,i.clickTime),this.finalizeNavMetrics(),C(i),this.routeCfg=i,this.setTiming(b.CLICK,i.clickTime),this.setState({}))})),_defineProperty(this,"onBeaconBroadcast",(e=>{A("Beacon %s %d",e.status,e.timestamp),e.status===b.EMPTY?(this.navEndedInEmptyState=!0,this.setTiming(b.COMPLETED,e.timestamp)):this.setTiming(e.status,e.timestamp)})),_defineProperty(this,"setTiming",((e,t)=>{var i=this.navTimings,o=!1;this.isNavCompleted()?A("already completed"):(e===b.CLICK||i[b.CLICK]||A.warn("PageMetricMonitor.setTiming(%s) called, but clickTime should already be set. The clickTime should only be set on mount or prop change.",e),r()(P,(r=>{(o=o||e===r)&&!i[r]&&(i[r]=t,A("%s %d (%dms)",r,t,t-i[b.CLICK]))})),this.isNavCompleted()&&this.logNavBizMetric())})),_defineProperty(this,"isNavCompleted",(()=>void 0!==this.navTimings[b.COMPLETED])),_defineProperty(this,"finalizeNavMetrics",(()=>{var e=this.routeCfg;this.isBizMetricLogged||(this.navTimings[b.ATF]&&!this.navTimings[b.COMPLETED]?(A("finalizeNavMetric - received ATF but not COMPLETED, which is close enough for biz metric"),this.setTiming(b.COMPLETED,Date.now())):(Date.now()-this.navTimings[b.CLICK]>2e4&&A.error("PageMetricMonitor did not see ATF. Missing beacons? pageContext: ".concat(e.pageContext)),A("finalizeNavMetric - did not receive ATF, so only log biz metric"),this.logNavBizMetric())),this.navTimings={},this.navEndedInEmptyState=this.isBizMetricLogged=!1})),_defineProperty(this,"logNavBizMetric",(()=>{var e=this.routeCfg,t=this.navTimings[b.CLICK],i=this.navTimings[b.COMPLETED],o=void 0===i;i=i||Date.now(),v.A.log("PageView",{startTime:t,endTime:i,eventState:o?"cancelled":"complete"},e.pageContext),this.isBizMetricLogged=!0}))}getChildContext(){var e=this.routeCfg;return{beaconListener:this.onBeaconBroadcast,metricContextName:"",pageContext:e.pageContext,viewName:e.viewName}}UNSAFE_componentWillMount(){var e=g.A.getProperty("route.metrics");C(e),this.routeCfg=e,m.A.listen("routeChanged",this.onRouteChanged,this,99),this.navTimings={},A("==== willMount context: %s, clickTime: %d",e.pageContext,e.clickTime),this.setTiming(b.CLICK,e.clickTime),this.isBizMetricLogged=!1,this.navEndedInEmptyState=!1}componentWillUnmount(){m.A.unListen("routeChanged",null,this),this.finalizeNavMetrics()}render(){return p.createElement(e,this.props)}}return _defineProperty(PageMetricMonitor,"displayName","PageMetricMonitor(".concat(e.displayName,")")),_defineProperty(PageMetricMonitor,"childContextTypes",{beaconListener:u().func,metricContextName:u().string,pageContext:u().string,viewName:u().string}),PageMetricMonitor}},42749:(e,t,i)=>{i.d(t,{A:()=>l});var o=i(90179),r=i.n(o),n=i(35880),s=i.n(n),a=Object.freeze({CLICK:"clickTime",PLACEHOLDERS:"placeholdersRendered",DATA:"dataLoaded",ATF:"aboveTheFold",COMPLETED:"completed",EMPTY:"emptyStateRendered"});const l=Object.freeze({types:a,beaconTypes:Object.freeze(s()(r()(a,"CLICK"))),timingTypes:Object.freeze(["completed","aboveTheFold","dataLoaded","placeholdersRendered","clickTime"])})},31682:(e,t,i)=>{i.d(t,{A:()=>f});var o=i(87612),r=i.n(o),n=i(84684),s=i.n(n),a=i(43346),l=i.n(a),c=i(96540),d=i(35994),p=i(78439),h=i(21572),u=i(18742),m=i(43840),g=i(69944);function Delete(e){this.init(l()(e,{metricName:"MoveToTrash",batchSize:50})),s()(this,{message:(0,h.A)("amazon-photos-deleting",[this.items.length],this.items.length)})}Delete.prototype=new g.A,l()(Delete.prototype,{success(){d.A.emit("deselectAll"),d.A.emit("uncache"),d.A.emit("removeModels",this.successItems),d.A.emit("refreshQuota"),d.A.emit("showToast",{name:"DeleteToastSuccess",className:"success",message:(0,h.A)("amazon-photos-delete-success",[this.successItems.length],this.successItems.length),action:c.createElement(m.A,{name:"view-trash",href:u.A.getProperty("urls.trash")},(0,h.A)("amazon-photos-view-item")),icon:"delete"})},failure(){d.A.emit("unselectItem",this.successItems),d.A.emit("uncache"),d.A.emit("removeModels",this.successItems),d.A.emit("showToast",{message:(0,h.A)("amazon-photos-delete-fail"),className:"fail",icon:"delete"})},culled(){d.A.emit("showToast",{message:(0,h.A)("amazon-photos-shared-delete-fail",[this.culledItems.length],this.culledItems.length),className:"fail",icon:"delete"})},cullInvalidItems(){return r()(this.items,(e=>e.canDelete()))},task(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return p.A.trash({nodes:e,recurse:e[0].isAlbum()?"false":"true"})}});const f=Delete},69944:(e,t,i)=>{i.d(t,{A:()=>I});var o=i(7309),r=i.n(o),n=i(39754),s=i.n(n),a=i(44383),l=i.n(a),c=i(39729),d=i.n(c),p=i(66245),h=i.n(p),u=i(43346),m=i.n(u),g=i(97200),f=i.n(g),v=i(63950),y=i.n(v),b=i(74692),P=i.n(b),A=i(35994),C=i(14780),w=i(37023),_=i(1683),O=i(73725),T=i(71086),E=i(42843);function _defineProperty(e,t,i){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var S=O.A.createLogger("Operations","info");const I=class GenericOperation{constructor(){_defineProperty(this,"cancelled",!1),_defineProperty(this,"cdsDelay",E.A.MID),_defineProperty(this,"batchSize",1),_defineProperty(this,"activeLimit",4),_defineProperty(this,"priority",2),_defineProperty(this,"eventTag",""),_defineProperty(this,"eventState",""),_defineProperty(this,"skipBizMetric",!1),_defineProperty(this,"itemsAreNotNodes",!1),_defineProperty(this,"fakeProgress",!1),_defineProperty(this,"pauseOnFailure",!1),_defineProperty(this,"onBatchFail",y()),_defineProperty(this,"blockingProgressDialog",{}),_defineProperty(this,"showToast",!0),_defineProperty(this,"showProgressToast",!0),_defineProperty(this,"showSuccessToast",!0),_defineProperty(this,"closeable",!1),_defineProperty(this,"stay",!0),_defineProperty(this,"id","operation-"+f()()),_defineProperty(this,"icon","spinner")}init(e){return m()(this,e),this.success=this.success||y(),this.failure=this.failure||y(),this.itemsWithErrors={},this.successItems=[],this.failedItems=[],this.culledItems=[],this.progressPercent=0,this.options=e,this.pageContext=T.A.getPageContext(),this.startTime=Date.now(),this.paused=!1,this.dfd=new(P().Deferred),this.batchOperationPromise,this}shouldShowBlockingProgress(){return this.blockingProgressDialog.name&&this.blockingProgressDialog.heading}showBlockingProgress(){var{name:e,heading:t}=this.blockingProgressDialog;A.A.emit("openDialog",{component:w.A,props:{heading:t,name:e,dfd:this.dfd}})}start(){var e=this;if(this.running)return this;if(this.running=!0,this.metricName||this.skipBizMetric||S.warn("No metricName provided for operation"),this.shouldShowBlockingProgress()?this.showBlockingProgress():this.showProgressToast&&this.toast(),A.A.emit("startOperation",this),this.cullInvalidItems){var t=this.cullInvalidItems();this.culledItems=h()(this.items,t),this.items=t}var i=C.A.addBatchAndReturnMetadata({batchSize:this.batchSize,activeLimit:this.activeLimit,operation:d()(this.task,this),items:this.items,successCallback:d()(this.successCallback,this),failCallback:d()(this.failCallback,this),progressCallback:d()(this.progressCallback,this),groupName:this.groupName,priority:this.priority});return this.batchOperationPromise=i.promise,i.promise.always((function(){e.finished()})),this.prioritizerBatchId=i.batchId,this.fakeProgress&&this._startFakeProgress(),this}_startFakeProgress(){var e,t,i=0;this.fakeProgressInterval=window.setInterval((()=>{e=(i+=300)/2e4,t=Math.min(.9*e,.9),this.progressCallback(t),t>=.9&&window.clearTimeout(this.fakeProgressInterval)}),300)}toast(){var e;this.showToast&&this.message&&(e=l()(this,["id","icon","message","stay","closeable","progressPercent"]),this.paused&&(e.stay=!0,e.closeable=!1),e.name=this.metricName,A.A.emit("showToast",e))}successCallback(e,t){s()(t,(e=>{this.itemsWithErrors[e.id]?this.failedItems.push(e):this.successItems.push(e)})),this.progressPercent=this._progressPercent(),this.showSuccessToast&&this.toast(),this.dfd.notify(this.progressPercent)}failCallback(e,t,i,o){this.failedItems=this.failedItems.concat(e),this.progressPercent=this._progressPercent(),this.pauseOnFailure&&(this.onBatchFail(e,o),this.paused=!0,this.toast()),this.dfd.notify(this.progressPercent),this.pauseOnFailure||C.A.failureResume(t)}resumeAfterFailure(){this.paused=!1,this.toast(),C.A.failureResume(this.prioritizerBatchId)}progressCallback(e){this.progressPercent=100*e,this.showProgressToast&&this.toast(),this.dfd.notify(this.progressPercent)}getPromise(){return this.dfd.promise()}_progressPercent(){return(this.successItems.length+this.failedItems.length)/this.items.length*100}cancel(){this.cancelled=!0,C.A.abortBatch(this.prioritizerBatchId)}finished(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.successItems,t=this,i=Date.now(),o=this.eventTag;this.fakeProgressInterval&&window.clearInterval(this.fakeProgressInterval),window.setTimeout((function(){t.successItems.length?(t.success(e),t.dfd.resolve(e)):(t.dfd.reject(e),t.failure(e)),t.culledItems.length&&t.culled&&t.culled(),t.shouldShowBlockingProgress()&&A.A.emit("closeDialog"),t.showToast&&t.showSuccessToast&&t.message&&t.id&&A.A.emit("showToast",{id:t.id,stay:!1,timeout:333,icon:"done-inline"})}),this.cdsDelay),A.A.emit("endOperation",this),this.metricName&&(o||this.itemsAreNotNodes||r()(this.successItems,(function(e){return"function"!=typeof e.getNodeType||(o=o||e.getNodeType())!==e.getNodeType()?(o="MIXED",!0):void 0})),this.skipBizMetric||_.A.log(this.metricName,{eventTag:o,eventCount:this.successItems.length,startTime:this.startTime,endTime:i,eventState:this.eventState,data:{failCount:this.failedItems.length}},this.pageContext),S("Completed %s -- eventTag: %s, success: %d, fail: %s, duration: %s, pageContext: %s",this.metricName,this.eventTag,this.successItems.length,this.failedItems.length,i-this.startTime,this.pageContext))}}},19625:(e,t,i)=>{i.d(t,{A:()=>p});var o=i(40860),r=i.n(o),n=i(84684),s=i.n(n),a=i(35994),l=i(78439),c=i(69944),d=i(21572);class Hide extends c.A{constructor(e){super(...arguments);var{canHide:t,cannotHide:i}=this.itemsByType(e);this.init({metricName:"HideItems",batchSize:1,items:t,unhideableItems:i}),s()(this,{message:(0,d.A)("amazon-photos-hide",[this.items.length],this.items.length)})}itemsByType(e){var{items:t}=e;return r()(t,((e,t)=>(t.canHide()?e.canHide.push(t):e.cannotHide.push(t),e)),{canHide:[],cannotHide:[]})}success(){a.A.emit("deselectAll"),a.A.emit("uncache"),a.A.emit("removeModels",this.successItems),a.A.emit("showToast",{name:"HideToastSuccess",message:(0,d.A)("amazon-photos-hide-success",[this.successItems.length],this.successItems.length),className:"success",icon:"hide"}),this.unhideableItems.length&&a.A.emit("showToast",{name:"HideToastSuccessUnhidableItems",message:(0,d.A)("amazon-photos-unhidable-items",[this.unhideableItems.length],this.unhideableItems.length),className:"fail",icon:"hide"})}failure(){a.A.emit("unselectItem",this.successItems),a.A.emit("uncache"),a.A.emit("removeModels",this.successItems),a.A.emit("showToast",{name:"HideToastFail",message:(0,d.A)("amazon-photos-hide-fail",[this.failedItems.length],this.failedItems.length),className:"fail",icon:"hide"})}task(e){var t=(e=e||[])[0];return l.A.updateNode({id:t.id,data:{settings:{hidden:!0}}})}}const p=Hide},11031:(e,t,i)=>{i.d(t,{A:()=>p});var o=i(39729),r=i.n(o),n=i(43346),s=i.n(n),a=i(69944),l=i(78439),c=i(14780),d=function PopulateShareContainerOperation(e){s()(e,{metricName:"ShareItems"}),this.init(e)};d.prototype=new a.A,s()(d.prototype,{start:function start(){var e,t=this,i=this.options.shareName;l.A.createShareContainer({name:i}).done((function(i){e=i,c.A.addBatch({batchSize:25,priority:1,operation:function operation(t){if(t[0])return l.A.bulkAddChildren({parentId:e.id,ids:t.map((e=>"".concat(e.ownerId,":").concat(e.id)))})},items:t.items,successCallback:r()(t.successCallback,t),failCallback:r()(t.failCallback,t)}).always((function(){t.finished(e)}))}))}});const p=d},72231:(e,t,i)=>{i.d(t,{A:()=>h});var o=i(84684),r=i.n(o),n=i(43346),s=i.n(n),a=i(35994),l=i(69944),c=i(78439),d=i(21572),p=function TrashDelete(e){this.init(s()(e,{batchSize:50,activeLimit:4,metricName:"PurgeFromTrash"})),r()(this,{message:(0,d.A)("amazon-photos-trash-deleting",[e.items.length],e.items.length)})};p.prototype=new l.A,s()(p.prototype,{success:function success(){a.A.emit("uncache"),a.A.emit("removeModels",this.successItems),a.A.emit("deselectAll"),a.A.emit("showToast",{metricEventTag:"TrashDeleteToastSuccess",className:"success",message:(0,d.A)("amazon-photos-trash-delete-success",[this.successItems.length],this.successItems.length),icon:"delete"})},failure:function failure(){this.successItems.length&&(a.A.emit("uncache"),a.A.emit("removeModels",this.successItems),a.A.emit("unselectItem",this.successItems)),a.A.emit("showToast",{metricEventTag:"TrashDeleteToastFail",className:"fail",message:(0,d.A)("amazon-photos-trash-delete-fail",[this.failedItems.length],this.failedItems.length),icon:"delete"})},task:function task(e){return e=e||[],c.A.permanentlyDelete({nodes:e,recurse:!!e[0].isFolder()})}});const h=p},96056:(e,t,i)=>{i.d(t,{A:()=>h});var o=i(84684),r=i.n(o),n=i(43346),s=i.n(n),a=i(35994),l=i(69944),c=i(78439),d=i(21572),p=function TrashRestore(e){this.init(s()(e,{batchSize:50,activeLimit:4,metricName:"RestoreFromTrash"})),r()(this,{message:(0,d.A)("amazon-photos-trash-restoring",[e.items.length],e.items.length)})};p.prototype=new l.A,s()(p.prototype,{success:function success(){a.A.emit("uncache"),a.A.emit("addModels"),a.A.emit("deselectAll"),a.A.emit("showToast",{metricEventTag:"TrashRestoreToastSuccess",className:"success",message:(0,d.A)("amazon-photos-trash-restore-success",[this.successItems.length],this.successItems.length),icon:"restore"})},failure:function failure(){this.successItems.length&&(a.A.emit("uncache"),a.A.emit("addModels"),a.A.emit("unselectItem",this.successItems)),a.A.emit("showToast",{metricEventTag:"TrashRestoreToastFail",className:"fail",message:(0,d.A)("amazon-photos-trash-restore-fail",[this.failedItems.length],this.failedItems.length),icon:"restore"})},task:function task(e){return e=e||[],c.A.restore({nodes:e})}});const h=p},7574:(e,t,i)=>{i.d(t,{A:()=>h});var o=i(84684),r=i.n(o),n=i(43346),s=i.n(n),a=i(35994),l=i(78439),c=i(69944),d=i(21572),p=function Unhide(e){this.init(s()(e,{metricName:"UnhideItems",batchSize:1})),r()(this,{message:(0,d.A)("amazon-photos-unhide",[this.items.length],this.items.length)})};p.prototype=new c.A,s()(p.prototype,{success:function success(){a.A.emit("deselectAll"),a.A.emit("uncache"),a.A.emit("removeModels",this.successItems),a.A.emit("showToast",{name:"UnhideToastSuccess",message:(0,d.A)("amazon-photos-unhide-success",[this.successItems.length],this.successItems.length),className:"success",icon:"unhide"})},failure:function failure(){a.A.emit("unselectItem",this.successItems),a.A.emit("uncache"),a.A.emit("removeModels",this.successItems),a.A.emit("showToast",{name:"UnhideToastFail",message:(0,d.A)("amazon-photos-unhide-fail",[this.failedItems.length],this.failedItems.length),className:"fail",icon:"unhide"})},task:function task(e){var t=(e=e||[])[0];return l.A.updateNode({id:t.id,data:{settings:{hidden:!1}}})}});const h=p},78439:(e,t,i)=>{i.d(t,{A:()=>l});var o=i(2832),r=i(18742),n=i(97463),s=i(38364),a=i(71086);function ownKeys(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(i),!0).forEach((function(t){_defineProperty(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ownKeys(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function _defineProperty(e,t,i){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class CloudDriveServiceClient extends o.A{get config(){return{endPoint:r.A.getProperty("urls.driveServiceEndpoint"),limit:r.A.getProperty("limit"),language:n.A.getProperty("language"),deviceId:r.A.getProperty("client.deviceSerial"),shareId:a.A.getProperty("route.props.shareId",""),groupShareToken:a.A.getProperty("route.props.shareToken",""),applicationId:r.A.getProperty("applicationId")}}callService(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i={"Accept-Language":n.A.getProperty("language","en_US"),"x-amz-clouddrive-appid":this.config.applicationId},o=null!==(e=null==t?void 0:t.data)&&void 0!==e?e:{},r=_objectSpread(_objectSpread({},t),{},{data:_objectSpread(_objectSpread({},o),{},{resourceVersion:"V2",ContentType:"JSON"}),shouldShowUnauthDialog:!0});return(0,s.A)(r,this.config.endPoint,i)}}const l=new CloudDriveServiceClient},12017:(e,t,i)=>{i.d(t,{A:()=>s});var o=i(38364),r=i(56286),n=i(18742);class FaceManagementService extends r.A{get config(){return{endPoint:n.A.getProperty("urls.driveServiceEndpoint")}}callService(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.data=e.data||{},e.doNotAlertOnFatal=!0,(0,o.A)(e,this.config.endPoint)}}const s=new FaceManagementService},84723:(e,t,i)=>{i.d(t,{A:()=>p});var o=i(82306),r=i.n(o),n=i(74692),s=i.n(n),a=i(97463),l=i(35994);function asyncGeneratorStep(e,t,i,o,r,n,s){try{var a=e[n](s),l=a.value}catch(e){return void i(e)}a.done?t(l):Promise.resolve(l).then(o,r)}function _asyncToGenerator(e){return function(){var t=this,i=arguments;return new Promise((function(o,r){var n=e.apply(t,i);function _next(e){asyncGeneratorStep(n,o,r,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(n,o,r,_next,_throw,"throw",e)}_next(void 0)}))}}var c=function hzAjax(e,t,i){return s().ajax({url:e,data:t,type:i||"GET",cache:!1,traditional:!0,beforeSend:function beforeSend(e){e.setRequestHeader("x-amzn-SessionId",a.A.getProperty("sessionId"))}})},d=function performRequest(){var e=r()(arguments),t=function req(){return c.apply(null,e)};return t().then(null,t)},isAuthenticated=()=>a.A.getProperty("authenticated"),setCDPref=(e,t)=>{if(isAuthenticated())return s().post("/photos/utils/setCDPref",{key:e,value:t})};const p={recordWeblabTrigger:function recordWeblabTrigger(e){return d("/photos/utils/weblab/trigger",{weblabName:e},"POST")},changeLanguage:function changeLanguage(e){return d("/photos?sf=1&language="+e)},setPreferredEmailClient:function setPreferredEmailClient(e){return setCDPref("preferredEmailClient",e)},setPreferredDisplayType:function setPreferredDisplayType(e){return setCDPref("gridViewPreferredDisplay",e)},setCDPref,clearCDPref:function clearCDPref(e){if(isAuthenticated())return s().post("/photos/utils/clearCDPref",{key:e})},sendSmsNotification:function sendSmsNotification(e){var t=s().Deferred(),i=e.replace(/\D/g,""),o={sessionId:a.A.getProperty("sessionId"),address:i};return d("/gp/photos/widgets/notification-widget.html",o,"POST").done((e=>{e.isOK?t.resolve(e):t.reject(e)})).fail(t.reject),t.promise()},setAutoRenewPreference:(e,t)=>_asyncToGenerator((function*(){var i={value:t,subscriptionId:e};try{yield d("/photos/storage/setAutoRenew",i)}catch(e){if(401!==e.status)throw e;l.A.emit("userUnauthorized")}}))(),cancelPlan:e=>_asyncToGenerator((function*(){var t={subscriptionId:e};try{yield d("/photos/storage/cancelAction",t)}catch(e){if(401!==e.status)throw e;l.A.emit("userUnauthorized")}}))()}},67172:(e,t,i)=>{i.d(t,{A:()=>c});var o=i(84684),r=i.n(o),n=i(18742),s=i(97463),a=i(20771),l=i(38364);class PromptoClient extends a.A{get config(){return{endPoint:n.A.getProperty("urls.promptoServiceEndpoint"),customerId:s.A.getProperty("customerId"),authenticated:s.A.getProperty("authenticated")&&s.A.getProperty("isValidMarketplace"),language:s.A.getProperty("language"),applicationId:n.A.getProperty("applicationId")}}callService(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.data=e.data||{};var t={"x-amz-clouddrive-appid":this.config.applicationId};return r()(e,{shouldShowUnauthDialog:!0,noCache:!0}),(0,l.A)(e,"".concat(this.config.endPoint),t)}}const c=new PromptoClient},92854:(e,t,i)=>{i.d(t,{A:()=>s});var o=i(18742),r=i(38364),n=i(96005);class SuliCallServiceClient extends n.A{get config(){return{endpoint:o.A.getProperty("urls.suliServiceEndpoint"),limit:o.A.getProperty("limit"),applicationId:o.A.getProperty("applicationId")}}call(e){e.shouldShowUnauthDialog=!0;var t={"x-amz-clouddrive-appid":this.config.applicationId};return(0,r.A)(e,this.config.endpoint,t)}}const s=new SuliCallServiceClient},38364:(e,t,i)=>{i.d(t,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var o=i(38221),r=i.n(o),n=i(84684),s=i.n(n),a=i(44383),l=i.n(a),c=i(39754),d=i.n(c),p=i(60895),h=i.n(p),u=i(74692),m=i.n(u),g=i(53110),f=i(35994),v=i(73725),y=i(90463),b=i(47763),P=["acceptableErrorCodes","disableRetryHandling","disableRetryOnTimeout","doNotAlertOnFatal","maxRetries","shouldReturnNativePromise","shouldShowUnauthDialog","metricName"];function ownKeys(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(i),!0).forEach((function(t){_defineProperty(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ownKeys(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function _defineProperty(e,t,i){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _objectWithoutProperties(e,t){if(null==e)return{};var i,o,r=function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var i,o,r={},n=Object.keys(e);for(o=0;o<n.length;o++)i=n[o],t.indexOf(i)>=0||(r[i]=e[i]);return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)i=n[o],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}var A=[409],C=3;function __WEBPACK_DEFAULT_EXPORT__(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,{acceptableErrorCodes:o=[],disableRetryHandling:r,disableRetryOnTimeout:n,doNotAlertOnFatal:s,maxRetries:a=C,shouldReturnNativePromise:l=!1,shouldShowUnauthDialog:c=!1,metricName:d}=e,p=_objectWithoutProperties(e,P),u=[...A,...o],y=m().Deferred(),_=_objectSpread(_objectSpread({},p),{},{data:m().extend(!0,{},e.data),url:w(e.url,t),withCredentials:e.withCredentials}),S=0,requestWrapper=()=>{O(_,i).done(((e,t,i)=>{d&&(0,b.ak)(d,!0,S),y.resolve(e,i)})).fail((e=>{var{responseText:t,status:i,statusText:o}=e;if(u.includes(i))y.reject(e);else{var l=JSON.stringify({url:_.url,serviceRequestId:e.getResponseHeader("x-amzn-RequestId"),status:0===i?o:i,responseText:t});if(r||!(429===i||i>=500||0===i||"timeout"===o&&!n))return v.A.error("serviceError",l),y.reject(e),void function handleUnauthorizedResponse(e,t){e&&(null==t?void 0:t.status)===g.kG.Unauthorized&&f.A.emit("userUnauthorized")}(c,e);S<a?(S+=1,v.A.error("serviceError: Attempt #".concat(S),l),h()(requestWrapper,E(S))):(v.A.fatal("serviceError: Max retry exceeded (".concat(a,")"),l),d&&(0,b.ak)(d,!1,S),s||T(),y.reject(e))}}))};requestWrapper();var I=y.promise();return l?Promise.resolve(I):I}(0,y.iT)(10),f.A.listen("uncache",y.RI);var w=function _createFullUrl(e,t){return"https"===e.substr(0,5)||e.substr(0,t.length)===t?e:t+e},_=function _beforeSend(e){var t=i(97463).A;return function(i){d()(e,((e,t)=>{i.setRequestHeader(t,e)})),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.setRequestHeader("x-amzn-SessionId",t.getProperty("sessionId"))}},O=function _performRequest(e,t){var i,o=l()(e||{},["dataType","type","url","success","error","timeout","noCache","data","precacheKey"]);return s()(o,{dataType:"json",contentType:"application/json",type:"GET",cache:!1,beforeSend:_(t),timeout:"20000",traditional:!0}),o.xhrFields={withCredentials:null===(i=e.withCredentials)||void 0===i||i},"GET"===o.type.toUpperCase()?(0,y.Ay)(o,m().ajax):(-1===["GET","HEAD"].indexOf(o.type.toUpperCase())&&(o.data=JSON.stringify(o.data)),m().ajax(o))},T=r()((()=>f.A.emit("service-failure")),5e3,{leading:!0}),E=function calcRetryDelay(e){var t=Math.min(Math.pow(5,e+1),3e3);return 10*Math.round(t*(1+.5*Math.random()))}},10384:(e,t,i)=>{i.d(t,{A:()=>createShareUrl});var o=i(18742);function createShareUrl(e){var{baseAppUrl:t,share:i}=o.A.getProperty("urls",{}),{protocol:r,hostname:n}=window.location;return"".concat(r,"//").concat(n).concat(t).concat(i,"/").concat(e)}},49744:(e,t,i)=>{i.d(t,{A:()=>r});var o=i(21572);const r=function generateEmail(e){var t,i,{template:r="",nodes:n=[],url:s}=e;return 1===n.length&&n[0].isAlbum()?(t=(0,o.A)("amazon-photos-shared-album-email-subject"),i=(0,o.A)("amazon-photos-shared-album-email-body")):(t=(0,o.A)("amazon-photos-shared-photos-email-subject"),i=(0,o.A)("amazon-photos-shared-photos-email-body")),i+=" "+s,r.replace("#SUBJECT",encodeURIComponent(t)).replace("#BODY",encodeURIComponent(i))}},21572:(e,t,i)=>{i.d(t,{A:()=>getStringFluxAdapter});var o=i(44804),r=i(87791);function getStringFluxAdapter(e,t,i){return o.A.data.stringDebug?e:(0,r.A)(o.A.data,e,t,i)}},82595:(e,t,i)=>{i.d(t,{A:()=>getLocaleCollatorFlux});var o=i(97463),r=i(88842);function ownKeys(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function _defineProperty(e,t,i){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function getLocaleCollatorFlux(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e=function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(i),!0).forEach((function(t){_defineProperty(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ownKeys(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({locale:o.A.getProperty("language")},e),(0,r.A)(e)}},27236:(e,t,i)=>{i.d(t,{A:()=>r});var o=i(18742);const r={isAndroid:function isAndroid(){return o.A.data.device.isAndroid},isIOS:function isIOS(){return o.A.data.device.isIOS},isKindle:function isKindle(){return o.A.data.device.isKindle},isFireTablet:function isFireTablet(){return o.A.data.device.isFireTablet}}},66569:(e,t,i)=>{i.d(t,{A:()=>navigate});var o=i(14324),r=i(18742),n=i(71086),s=i(73725),a=i(21572),l=5;function _navigate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{replace:i,historyState:o}=t,a=r.A.getProperty("urls.baseAppUrl"),l=n.A.getProperty("history"),c=e;try{c=c.match(new RegExp("^((https?://([^/]*))?".concat(a,")?([/?].*)?")))[4]}catch(e){s.A.error("Invalid href ".concat(c),"navigate")}if(c||(c=""),l)i?l.replace(a+c,o):l.push(a+c,o);else{var reNavigate=()=>{_navigate(c,t),n.A.unListen(reNavigate)};n.A.listen(reNavigate)}}function navigate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{discardSelection:r}=t,n=o.A.getProperty("selection");window.location.href===e||r||n&&n.getSize()<l?_navigate(e,t):function _confirmLoseSelection(e){(0,i(32239).A)((0,a.A)("amazon-photos-discard-selection-body"),{name:"ConfirmLoseSelectionDialog",heading:(0,a.A)("amazon-photos-discard-selection-title"),confirmText:(0,a.A)("amazon-photos-ok"),onConfirmClick:e})}((()=>_navigate(e,t)))}},47389:(e,t,i)=>{i.d(t,{A:()=>p});var o=i(35880),r=i.n(o),n=i(44383),s=i.n(n),a=i(55488),l=i(59786),c=i(66569),d=["sort"];class PageURLFluxAdapter extends l.A{go(e,t,i){return(0,c.A)(this.toString(),{replace:e,trigger:t,historyState:i}),this}clone(){return new PageURLFluxAdapter(this.base,this._urlData.queryMap)}isUsingFilters(){var e=s()(this.query,a.Z9);return Boolean(r()(e).length)}isUsingFiltersOrSort(){var e=s()(this.query,d);return Boolean(r()(e).length)||this.isUsingFilters()}}PageURLFluxAdapter.FILTER_PARAM_NAMES=Object.freeze(a.Z9),PageURLFluxAdapter.SORT_PARAM_NAMES=Object.freeze(d);const p=PageURLFluxAdapter},32239:(e,t,i)=>{i.d(t,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var o=i(84684),r=i.n(o),n=i(35994),s=i(38530),a=i(21572);function __WEBPACK_DEFAULT_EXPORT__(e,t){var i;(t=r()(t,{heading:null,confirmText:(0,a.A)("amazon-photos-confirm"),cancelText:(0,a.A)("amazon-photos-cancel"),showCancel:!0,onConfirmClick:()=>{},onCancelClick:()=>{},pushDialog:!1,stackDialog:!1})).pushDialog=!!t.stackDialog||t.pushDialog;var o=t.pushDialog?"pushDialog":"openDialog";i={heading:t.heading,buttons:[{name:"confirm",label:t.confirmText,onClick:t.onConfirmClick}],children:e,name:t.name},t.showCancel&&i.buttons.unshift({label:t.cancelText,name:"cancel",className:"button-secondary",onClick:t.onCancelClick}),n.A.emit(o,{component:s.A,id:t.id,props:i,isStacked:t.stackDialog})}},37763:(e,t,i)=>{i.d(t,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var o=i(35994),r=i(38530);function __WEBPACK_DEFAULT_EXPORT__(e,t){e&&((t=t||{}).children=e,o.A.emit("openDialog",{component:r.A,id:t.id,props:t}))}},68564:(e,t,i)=>{i.d(t,{A:()=>u});var o=i(32485),r=i.n(o),n=i(96540),s=i(5556),a=i.n(s),l=i(35994),c=i(84503),d=i(49479),p=i(21572),h=i(71086);function _defineProperty(e,t,i){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class LivePhotoButton extends n.Component{constructor(){super(...arguments),_defineProperty(this,"onClick",(()=>{var{model:e,videoId:t,videoPlaying:i}=this.props;i?l.A.emit("pauseVideo"):l.A.emit("playVideo",e.id!==t&&e.id)}))}render(){var{showLabel:e,videoPlaying:t}=this.props,i=r()("live-photo-button",{playing:t,paused:!t});return n.createElement(c.A,{className:i,metricOverrides:{eventName:"PlayLivePhoto",eventTag:"button"},name:"live-photo-button",onClick:this.onClick,stopPropagation:!0,title:(0,p.A)("amazon-photos-live-text")},e&&n.createElement("span",{className:"label"},(0,p.A)("amazon-photos-live-button")))}}_defineProperty(LivePhotoButton,"propTypes",{model:a().instanceOf(d.A).isRequired,showLabel:a().bool});const u=l.A.connect(LivePhotoButton,[{store:h.A,mapToProps:["videoId","videoPlaying"]}])},42852:(e,t,i)=>{i.d(t,{A:()=>collectionConnector});var o=i(96540),r=i(5556),n=i.n(r),s=i(51158);function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},_extends.apply(this,arguments)}function _defineProperty(e,t,i){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function collectionConnector(e){class ConnectedComponent extends o.Component{constructor(){super(...arguments),_defineProperty(this,"onCollectionChange",(()=>{this.forceUpdate()}))}UNSAFE_componentWillMount(){var{collection:e}=this.props;e&&this.connect(e)}componentWillUnmount(){var{collection:e}=this.props;e&&this.disconnect(e)}UNSAFE_componentWillReceiveProps(e){var{collection:t}=this.props;e.collection!==t&&(this.disconnect(t),this.connect(e.collection))}connect(e){e&&(this.disconnect(e),e.listen(this.onCollectionChange,this))}disconnect(e){e&&e.unListen(null,this)}render(){var t=this.props.collection;return t?o.createElement(e,_extends({collection:t,count:t.count,uid:t.uid},this.props)):null}}return _defineProperty(ConnectedComponent,"propTypes",{collection:n().instanceOf(s.A)}),_defineProperty(ConnectedComponent,"displayName","CollectionConnected(".concat(e.displayName||e.name||"Component",")")),ConnectedComponent}},56718:(e,t,i)=>{i.d(t,{A:()=>P});var o=i(79859),r=i.n(o),n=i(96540),s=i(5556),a=i.n(s),l=i(74692),c=i.n(l),d=i(32485),p=i.n(d),h=i(35994),u=i(1583),m=i(7138),g=i(1683),f=i(18742),v=["name","className","noClose","progressPercent","addKeyboardPadding"];function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},_extends.apply(this,arguments)}function _objectWithoutProperties(e,t){if(null==e)return{};var i,o,r=function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var i,o,r={},n=Object.keys(e);for(o=0;o<n.length;o++)i=n[o],t.indexOf(i)>=0||(r[i]=e[i]);return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)i=n[o],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function _defineProperty(e,t,i){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var y="[href], [contentEditable], button, input, select, textarea",b=["input","textarea"];class FluxDialog extends((0,m.A)(n.Component,{usePropName:!0})){constructor(){super(...arguments),_defineProperty(this,"state",{}),_defineProperty(this,"elements",{}),_defineProperty(this,"onCloseClick",(e=>{e.stopPropagation(),this.props.noClose||Number.isFinite(this.props.progressPercent)||this.closeDialog()})),_defineProperty(this,"onEscape",(()=>{if(!this.props.noClose&&!Number.isFinite(this.props.progressPercent))return this.closeDialog(),!1})),_defineProperty(this,"onTab",(()=>{c()(this.elements.dialog).find(":focus").length||this.setBeginningFocus()})),_defineProperty(this,"onFocus",(e=>{var t=f.A.getProperty("device"),i=(null==t?void 0:t.isMobile)||(null==t?void 0:t.isTablet),o=e.target.tagName.toLowerCase();i&&(r()(b,o)||"true"===e.target.contentEditable)&&this.setState({keyboardOpen:!0})})),_defineProperty(this,"onBlur",(()=>{this.state.keyboardOpen&&this.setState({keyboardOpen:!1})})),_defineProperty(this,"onTrapFocus",(e=>{c()(e.currentTarget).hasClass("end")?this.setBeginningFocus():this.setEndFocus()})),_defineProperty(this,"setDialogRef",(e=>{this.elements.dialog=e})),_defineProperty(this,"setContentRef",(e=>{this.elements.content=e})),_defineProperty(this,"setFooterRef",(e=>{this.elements.footer=e}))}UNSAFE_componentWillMount(){f.A.getProperty("device.isIOS")&&h.A.emit("enterFullScreen")}componentWillUnmount(){var{name:e}=this.props;!this.isClosed&&this.props.onClose&&this.props.onClose(),h.A.emit("resumeKeyEvents",{reserveFor:e}),h.A.unListen("".concat(e,".escape"),this.onEscape,this),h.A.unListen("".concat(e,".tab"),this.onTab,this),f.A.getProperty("device.isIOS")&&h.A.emit("exitFullScreen")}componentDidMount(){var{name:e}=this.props;h.A.emit("stopKeyEvents",{reserveFor:e}),h.A.listen("".concat(e,".escape"),this.onEscape,this,!0),h.A.listen("".concat(e,".tab"),this.onTab,this,!0),this.storeDialogHeights(),this.setDialogHeights(),g.A.log("ShowDialog",{eventTag:e},this.context.pageContext)}componentDidUpdate(){this.props.disableResizeTransition||this.setDialogHeights()}setDialogHeights(){this.elements.content&&this.setDialogComponentHeight(c()(this.elements.content)),this.elements.footer&&this.setDialogComponentHeight(c()(this.elements.footer))}storeDialogHeights(){this.elements.content&&this.storeDialogComponentHeight(c()(this.elements.content)),this.elements.footer&&this.storeDialogComponentHeight(c()(this.elements.footer))}UNSAFE_componentWillUpdate(){this.storeDialogHeights()}storeDialogComponentHeight(e){var t=e.outerHeight();e.data("height",t)}setDialogComponentHeight(e){e.removeAttr("style");var t=e.outerHeight(),i=e.data("height");i&&t!==i&&e.css("height",i).animate({height:t},333,(()=>{e.removeAttr("style")}))}setBeginningFocus(){c()(this.elements.dialog).find(y).not(".focustrap").first().focus()}setEndFocus(){c()(this.elements.dialog).find(y).not(".focustrap").last().focus()}closeDialog(){var{onClose:e}=this.props;this.isClosed=!0,h.A.emit("closeDialog",{id:this.props.id}),e&&e(this.props.id)}render(){var e=this.props,{name:t,className:i,noClose:o,progressPercent:r,addKeyboardPadding:s}=e,a=_objectWithoutProperties(e,v),l=p()(i||t),{overlayStyle:c,keyboardOpen:d}=this.state,h=o;return Number.isFinite(r)&&(h=!0),n.createElement(u.A,_extends({},a,{name:t,className:l,style:c,onFocus:this.onFocus,onBlur:this.onBlur,onTrapFocus:this.onTrapFocus,noClose:h,progressPercent:r,addKeyboardPadding:s||d,onCloseRequest:this.onCloseClick,dialogRef:this.setDialogRef,contentRef:this.setContentRef,footerRef:this.setFooterRef}))}}_defineProperty(FluxDialog,"displayName","Dialog"),_defineProperty(FluxDialog,"contextTypes",{pageContext:a().string});const P=FluxDialog},17050:(e,t,i)=>{i.d(t,{A:()=>SideDialog});var o=i(96540),r=i(32485),n=i.n(r),s=i(56718),a=i(1583),l=["name","className","noClose","progressPercent","addKeyboardPadding"];function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},_extends.apply(this,arguments)}function _objectWithoutProperties(e,t){if(null==e)return{};var i,o,r=function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var i,o,r={},n=Object.keys(e);for(o=0;o<n.length;o++)i=n[o],t.indexOf(i)>=0||(r[i]=e[i]);return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)i=n[o],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}class SideDialog extends s.A{closeDialog(){window.clearTimeout(this.timer),this.setState({visible:!1}),this.timer=window.setTimeout((()=>super.closeDialog()),333)}componentDidMount(){super.componentDidMount(...arguments),this.setState({visible:!0})}componentWillUnmount(){super.componentWillUnmount(...arguments),window.clearTimeout(this.timer)}render(){var e=this.props,{name:t,className:i,noClose:r,progressPercent:s,addKeyboardPadding:c}=e,d=_objectWithoutProperties(e,l),{visible:p,overlayStyle:h}=this.state;return i=n()("side-dialog",i||t,{visible:p}),Number.isFinite(s)&&(r=!0),o.createElement(a.A,_extends({},d,{name:t,className:i,style:h,onFocus:this.onFocus,onBlur:this.onBlur,onTrapFocus:this.onTrapFocus,noClose:r,progressPercent:s,addKeyboardPadding:c,onCloseRequest:this.onCloseClick,dialogRef:e=>this.elements.dialog=e,contentRef:e=>this.elements.content=e,footerRef:e=>this.elements.footer=e}))}}},38530:(e,t,i)=>{i.d(t,{A:()=>v});var o=i(85015),r=i.n(o),n=i(55378),s=i.n(n),a=i(96540),l=i(32485),c=i.n(l),d=i(35994),p=i(73725),h=i(21572),u=i(84503),m=i(43840),g=i(54205),f=i(56718);function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},_extends.apply(this,arguments)}function _defineProperty(e,t,i){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class SimpleDialog extends a.Component{constructor(){super(...arguments),_defineProperty(this,"buttonRefs",[]),_defineProperty(this,"getLinkComponent",(e=>{var t=u.A;return e.href&&(t=0===e.href.indexOf("http")?g.A:m.A),t})),_defineProperty(this,"getDefaultButtonConfigs",(()=>({ok:{label:(0,h.A)("amazon-photos-ok"),name:"ok"}}))),_defineProperty(this,"onClick",(e=>{e.noClose||d.A.emit("closeDialog",{id:this.props.id}),e.onClick&&e.onClick(e)}))}render(){var e=this,t=this.getDefaultButtonConfigs(),i=this.props.name,o=c()("simple-button-dialog",this.props.className||this.props.name);return this.buttonRefs=[],a.createElement(f.A,_extends({},this.props,{className:o,footer:a.createElement("div",{className:"options"},s()(this.props.buttons,(function(o,n){o=r()(o)?t[o]:o;var s=e.getLinkComponent(o);o.name||(p.A.warn("Missing button name in SimpleButtonDialog %s",i),o.name=i+"-"+n);var l="dialog-button-".concat(o.name||n);return a.createElement(s,_extends({},o,{key:o.name,className:c()("button",o.className),onClick:t=>e.onClick(o,t),discardSelection:!0,inputRef:t=>{e.buttonRefs[n]=t},id:l,role:"button","aria-label":o.label||o.name}),o.label)})))}),this.props.children)}}_defineProperty(SimpleDialog,"defaultProps",{buttons:[]});const v=SimpleDialog},37023:(e,t,i)=>{i.d(t,{A:()=>n});var o=i(96540),r=i(56718);class SimpleProgressDialog extends o.Component{constructor(){super(...arguments),this.state={progress:0}}UNSAFE_componentWillMount(){var{dfd:e}=this.props;e&&e.progress((e=>this.setState({progress:e}))).done((()=>this.setState({progress:100})))}render(){return o.createElement(r.A,{className:"simple-progress-dialog",name:this.props.name,noClose:!0,heading:this.props.heading,progressPercent:this.state.progress})}}const n=SimpleProgressDialog},94043:(e,t,i)=>{i.d(t,{A:()=>p});var o=i(43346),r=i.n(o),n=i(96540),s=i(90529),a=i(35994),l=i(84503),c=i(1683),d=i(7138);function _defineProperty(e,t,i){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class ToastAdapter extends((0,d.A)(s.A,{usePropName:!0})){constructor(){super(...arguments),_defineProperty(this,"hideAnimationTimeout",333)}componentDidMount(){super.componentDidMount();var{name:e}=this.props,{pageContext:t}=this.context;e!==ToastAdapter.defaultProps.name&&c.A.log("ShowToast",{eventTag:e},t)}componentWillUnmount(){super.componentWillUnmount(),window.clearTimeout(this.closeTimeout)}hide(){super.hide();var{id:e}=this.props;window.clearTimeout(this.closeTimeout),this.closeTimeout=window.setTimeout((()=>a.A.emit("closeToast",{id:e})),this.hideAnimationTimeout)}renderCloseButton(){var{closeable:e}=this.props;if(e)return this.columnWrapper("close",n.createElement(l.A,{name:"close-button",onClick:this.onCloseClick}))}renderMinimizeButton(){var{content:e,minimizable:t}=this.props;if(e&&t)return this.columnWrapper("minimizable",n.createElement(l.A,{name:"minimize-button",onClick:this.onMinimizeClick}))}}_defineProperty(ToastAdapter,"displayName","Toast"),_defineProperty(ToastAdapter,"defaultProps",r()({name:"toast",minimizable:!0},s.A.defaultProps));const p=ToastAdapter},58556:(e,t,i)=>{i.d(t,{A:()=>g});var o=i(1882),r=i.n(o),n=i(20414),s=i.n(n),a=i(96540),l=i(18742),c=i(84503),d=i(94788),p=i(73725),h=i(32485),u=i.n(h),m=i(27236);class CopyInputWidget extends a.Component{constructor(e,t){super(e,t),s()(this,["onInputFocus","onCopyClick"])}componentDidMount(){var{isMobile:e,isTablet:t}=l.A.getProperty("device",{});e||t||this.highlightInputField()}highlightInputField(){this.refs.copyInput.focus(),this.refs.copyInput.select()}onCopyClick(){this.highlightInputField(),document.execCommand("copy"),r()(this.props.onCopy)&&this.props.onCopy()}onInputFocus(){this.highlightInputField()}render(){var e,{name:t="copy",metricOverrides:i}=this.props,o=function browserSupportsCopy(){if(m.A.isIOS())return!1;try{document.queryCommandEnabled("copy")}catch(e){return p.A.debug("Browser threw exception checking for copy support.",e),!1}return document.queryCommandSupported("copy")}(),r=u()("copy-input",{"button-visible":o});return o&&(e=a.createElement(c.A,{name:t,metricOverrides:i,className:"copy-button button",onClick:this.onCopyClick},a.createElement(d.A,null,"amazon-photos-link-copy"))),a.createElement("div",{className:"copy-input-wrapper"},a.createElement("input",{ref:"copyInput",className:r,defaultValue:this.props.inputContent,onFocus:this.onInputFocus,readOnly:o}),e)}}const g=CopyInputWidget},28584:(e,t,i)=>{i.d(t,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var o=i(96540),r=i(32485),n=i.n(r),s=i(84503),a=i(5566),l=i(35994),c=i(21572),d=i(3489),p={gmail:"https://mail.google.com/mail/u/0/?view=cm&fs=1&tf=1&to=&su=#SUBJECT&body=#BODY",yahoo:"http://compose.mail.yahoo.com/?to=&subj=#SUBJECT&body=#BODY",outlook:"https://outlook.live.com/owa?rru=compose&to=&subject=#SUBJECT&body=#BODY",aol:"http://mail.aol.com/mail/compose-message.aspx?to=&subject=#SUBJECT&body=#BODY",mailto:"mailto:?subject=#SUBJECT&body=#BODY"},h=p.mailto,u=function openEmailClient(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{client:i,subject:o,body:r,onClientOpened:n}=t,s=p[i]||h,a=s.replace("#SUBJECT",encodeURIComponent(o)).replace("#BODY",encodeURIComponent(r));-1!==s.indexOf("http")?(e=>!!window.open(e)||(l.A.emit("showToast",{message:(0,c.A)("cloud-photos-disable-popup-blocker-message"),className:"fail"}),!1))(a)&&(e=!0):(window.location.href=a,e=!0),e&&n&&n(t)},onButtonClick=(e,t)=>{var{beforeClientOpens:i}=t;i?i(t,u):u(t)};const __WEBPACK_DEFAULT_EXPORT__=e=>{var{value:t,onChange:i,buttonLabel:r=(0,c.A)("amazon-photos-share-dialog-email-client"),className:l,subject:p,body:h,beforeClientOpens:u,onClientOpened:m,alignment:g,isDisabled:f,placeHolderText:v,fancySelectorClass:y}=e;return o.createElement("div",{className:n()("email-client-selector",l)},o.createElement(d.A,{className:y,onChange:i,value:t,alignment:g,label:f?v:null},o.createElement("option",{value:a.k.mailto},(0,c.A)("cloud-photos-default")),o.createElement("option",{value:a.k.gmail},(0,c.A)("cloud-photos-gmail")),o.createElement("option",{value:a.k.yahoo},(0,c.A)("cloud-photos-yahoo")),o.createElement("option",{value:a.k.outlook},(0,c.A)("cloud-photos-outlook-web")),o.createElement("option",{value:a.k.aol},(0,c.A)("cloud-photos-aol-mail"))),o.createElement(s.A,{name:"open-email",subject:p,body:h,client:t,onClientOpened:m,beforeClientOpens:u,onClick:onButtonClick,disabled:f},r))}},3489:(e,t,i)=>{i.d(t,{A:()=>h});var o=i(55378),r=i.n(o),n=i(96540),s=i(32485),a=i.n(s),l=i(32098),c=i(84503),d=["children","disabled","alignment","label"];function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},_extends.apply(this,arguments)}function _objectWithoutProperties(e,t){if(null==e)return{};var i,o,r=function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var i,o,r={},n=Object.keys(e);for(o=0;o<n.length;o++)i=n[o],t.indexOf(i)>=0||(r[i]=e[i]);return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)i=n[o],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function _defineProperty(e,t,i){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var p="event";class FancySelector extends n.Component{constructor(){super(...arguments),_defineProperty(this,"onOptionClick",((e,t)=>this.chooseOption(t.value)))}chooseOption(e){if(this.refs.selector&&e){var t,i=this.refs.selector;try{t=new window.Event(p)}catch(e){t=document.createEvent(p)}t.initEvent("change",!0,!0),this.value=i.value=e,i.dispatchEvent(t)}}render(){var e,t,i=this.props,{children:o,disabled:s,alignment:p,label:h}=i,u=_objectWithoutProperties(i,d),m=a()("fancy-selector",this.props.className,{disabled:s});return o&&o.length&&(t=o[0],e=r()(o,((e,i)=>{var{type:o,props:r}=e,{value:s,children:a}=r;if("option"!==o)throw"FancySelector component should only receive option elements as children";return s===this.props.value&&(t=e),n.createElement("li",{key:i},n.createElement(c.A,_extends({},r,{name:"selector-"+s,onClick:this.onOptionClick}),a))}))),n.createElement("span",{className:m},e&&n.createElement(l.A,{name:"fancy-selector-menu",disabled:s,text:h||t.props.children,alignment:p||"bottom"},n.createElement("ul",null,e)),n.createElement("select",_extends({disabled:s},u,{ref:"selector"}),o))}}const h=FancySelector},51650:(e,t,i)=>{i.d(t,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var o=i(96540),r=i(32485),n=i.n(r);const __WEBPACK_DEFAULT_EXPORT__=e=>{var{children:t,className:i,label:r,id:s,value:a,checked:l,onChange:c,name:d}=e;return o.createElement("label",{className:n()("radio-button",i),htmlFor:s},o.createElement("input",{type:"radio",name:d,className:"radio-input",value:a,id:s,checked:l,onChange:c,"aria-checked":l}),o.createElement("span",{className:"radio-label"},o.createElement("span",{className:"label"},r),t))}},86777:(e,t,i)=>{i.d(t,{A:()=>u});var o=i(55378),r=i.n(o),n=i(91648),s=i.n(n),a=i(20414),l=i.n(a),c=i(96540),d=i(85796),p=i(32485),h=i.n(p);class PhotoTiles extends c.Component{UNSAFE_componentWillMount(){this.setModels(this.props.models,this.props.limit,this.props.total),l()(this,"onImageError")}UNSAFE_componentWillReceiveProps(e){e.models!==this.props.models&&this.setModels(e.models,e.limit,e.total)}setModels(e,t,i){e=e||[],t=t||e.length,i=i||e.length,t&&(e=e.slice(0,t)),this.setState({models:e,total:i})}onImageError(e,t){this.setState({models:s()(this.state.models,t)})}render(){var e,t=h()("photo-tiles",this.props.className,"count-"+this.state.models.length);return this.props.placeholder||(e=r()(this.state.models,((e,t)=>{var i;return this.props.enableMoreOverlay&&t+1===this.state.models.length&&this.state.total>this.state.models.length&&(i=c.createElement("span",{className:"more","data-text":"+"+(this.state.total-this.state.models.length)})),c.createElement("div",{className:"tile tile-"+(t+1),key:e.id},c.createElement(d.A,{clip:!0,onError:this.onImageError,model:e,transition:this.props.transition}),i)}))),c.createElement("div",{className:t},e)}}PhotoTiles.defaultProps={limit:5,enableMoreOverlay:!0};const u=PhotoTiles},68:(e,t,i)=>{i.d(t,{A:()=>A});var o=i(55378),r=i.n(o),n=i(39754),s=i.n(n),a=i(84684),l=i.n(a),c=i(56449),d=i.n(c),p=i(74692),h=i.n(p),u=i(96540),m=i(5556),g=i.n(m),f=i(32485),v=i.n(f),y=i(61738);function _defineProperty(e,t,i){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var b,P="flexWrap"in(b=document.documentElement.style)||"WebkitFlexWrap"in b||"msFlexWrap"in b,getPercentage=(e,t)=>e/t*100;class Columns extends u.Component{constructor(){super(...arguments),_defineProperty(this,"calculateSizes",(e=>{e=l()(e||{},{overflow:!1,recalculate:!1,recalcCount:0});var t,i=this.elColumns,o=h()(i).children(),r=o.filter(".no-group"),n=i.clientWidth,a=n,c=this.props.sizeGroups,d={};c?(e.overflow&&o.addClass("overflow"),e.recalculate||o.removeClass("overflow"),o.removeAttr("style").each((function(e,t){if(c[e]){var i=h()(t),o=d[c[e]],r=i.width();o||(o=d[c[e]]={width:0,count:0}),o.width=Math.max(o.width,r),o.count++}})),P?s()(d,((e,t)=>{e.count>1&&o.filter(".group-".concat(t)).css({minWidth:getPercentage(e.width,n)+"%"})})):(s()(d,(function(e,t){var i=o.filter(".group-".concat(t)),r=e.width*i.length;r>a&&(e.width=Math.floor(a/i.length),r=e.width*i.length),a-=r,i.css({width:getPercentage(e.width,n)+"%"})})),r.css({width:getPercentage(a/r.length,n)+"%"}))):o.css({width:100/o.length+"%"}),o.each((function(i,o){((o=h()(o)).children().eq(0).outerWidth(!0)>o.width()+1||e.overflow)&&(e.recalcCount>0&&e.overflowColumn===i&&(o=o.prevAll().eq(e.recalcCount-1)),o.addClass("overflow"),t=i)})),t&&e.recalcCount<=o.length&&(e.recalcCount++,e.recalculate=!0,e.overflowColumn=t,this.calculateSizes(e))}))}UNSAFE_componentWillMount(){if(y.A.pickComponentState(this,"width"),d()(this.props.sizeGroups)&&d()(this.props.children)&&this.props.sizeGroups.length!==this.props.children.length)throw"Size groups don't match the columns provided."}componentWillUnmount(){y.A.endComponentState(this)}componentDidMount(){this.calculateSizes()}componentDidUpdate(){this.calculateSizes()}render(){var e=this.props.children,t=v()("columns",this.props.className,{flexbox:P});return u.createElement("div",{className:t,ref:e=>{this.elColumns=e}},r()(e,((e,t)=>{var i=this.props.sizeGroups&&this.props.sizeGroups[t],o=v()("column","column-"+(t+1),{["group-"+i]:i,"no-group":!i,empty:!e});return u.createElement("div",{key:t,className:o},u.createElement("div",{className:"column-size"},e))})))}}_defineProperty(Columns,"propTypes",{sizeGroups:g().array});const A=Columns},43840:(e,t,i)=>{i.d(t,{A:()=>m});var o=i(44383),r=i.n(o),n=i(58156),s=i.n(n),a=i(96540),l=i(5556),c=i.n(l),d=i(18742),p=i(66569),h=i(1683);function _defineProperty(e,t,i){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var u=i(73725).A.createLogger("ClickMetrics","info");class AppLink extends a.Component{constructor(e){super(e),_defineProperty(this,"onClick",(e=>{var t,{forceReload:i,name:o,onClick:n,stopPropagation:a}=this.props,{pageContext:l,metricContextName:c}=this.context;a&&e.stopPropagation();var d=1===e.button||e.metaKey,m=s()(this.props,"metricOverrides.eventName","clicked.".concat(o)),g=s()(this.props,"metricOverrides.eventTag",c),f=s()(this.props,"metricOverrides.eventCount"),v=s()(this.props,"metricOverrides.pageContext",l);u("AppLink ".concat(m,", eventTag: ").concat(g,", eventCount: ").concat(f,", pageContext: ").concat(v)),h.A.log(m,{eventTag:g,eventCount:f},v),i||(d||e.preventDefault(),n&&(t=n(e,this.props)),!1!==t&&(d||(0,p.A)(e.currentTarget.href,r()(this.props,["replace","discardSelection","historyState"]))))})),_defineProperty(this,"handleMouseEnter",(()=>{var{onMouseEnter:e}=this.props;e&&e()})),this.state={baseUrl:d.A.getProperty("urls.baseAppUrl")}}render(){var{children:e,className:t,draggable:i,name:o,style:r,target:n,title:s}=this.props,{href:l}=this.props,{baseUrl:c}=this.state,d=t||o;return l&&"#"!==l&&(0===l.indexOf(c)&&(l=l.substring(c.length)),"/"===l[0]&&(l=l.substring(1)),l="".concat(c,"/").concat(l)),a.createElement("a",{href:l,draggable:i,style:r,target:n,title:s,className:d,onClick:this.onClick,onMouseEnter:this.handleMouseEnter},e)}}_defineProperty(AppLink,"propTypes",{className:c().string,draggable:c().bool,href:c().string,metricOverrides:c().shape({eventName:c().string,eventTag:c().string,eventCount:c().number,pageContext:c().string}),name:c().string.isRequired,onClick:c().func,stopPropagation:c().bool,target:c().string,title:c().string}),_defineProperty(AppLink,"contextTypes",{pageContext:c().string.isRequired,metricContextName:c().string.isRequired});const m=AppLink},84503:(e,t,i)=>{i.d(t,{A:()=>p});var o=i(58156),r=i.n(o),n=i(1683),s=i(73725),a=i(96540),l=i(5556),c=i.n(l);function _defineProperty(e,t,i){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var d=s.A.createLogger("ClickMetrics","info");class ButtonLink extends a.Component{constructor(){super(...arguments),_defineProperty(this,"onClick",(e=>{this.props.stopPropagation&&e.stopPropagation();var t=r()(this.props,"metricOverrides.eventName","clicked.".concat(this.props.name)),i=r()(this.props,"metricOverrides.eventTag",this.context.metricContextName),o=r()(this.props,"metricOverrides.eventCount"),s=r()(this.props,"metricOverrides.pageContext",this.context.pageContext);!this.props.onClick||this.props.disabled||e.currentTarget.disabled||(e.preventDefault(),d("ButtonLink ".concat(t,", eventTag: ").concat(i,", eventCount: ").concat(o,", pageContext: ").concat(s)),n.A.log(t,{eventTag:i,eventCount:o},s),this.props.onClick(e,this.props))})),_defineProperty(this,"onKeyDown",(e=>{this.props.stopPropagation&&e.stopPropagation()})),_defineProperty(this,"onMouseOver",(e=>{this.props.onMouseOver&&this.props.onMouseOver(e,this.props)})),_defineProperty(this,"onMouseOut",(e=>{this.props.onMouseOut&&this.props.onMouseOut(e,this.props)})),_defineProperty(this,"cancelButtonFocus",(e=>{e.currentTarget.blur()}))}render(){var{className:e=this.props.name,type:t,disabled:i,style:o,title:r,label:n,inputRef:s}=this.props;return a.createElement("button",{className:e,type:t,style:o,disabled:i,onClick:this.onClick,onKeyDown:this.onKeyDown,title:r,onMouseUp:this.cancelButtonFocus,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,"aria-label":n,ref:s},this.props.children)}}_defineProperty(ButtonLink,"propTypes",{name:c().string.isRequired,stopPropagation:c().bool,metricOverrides:c().shape({eventName:c().string,eventTag:c().string,eventCount:c().number,pageContext:c().string}),label:c().string,inputRef:c().func}),_defineProperty(ButtonLink,"contextTypes",{pageContext:c().string.isRequired,metricContextName:c().string.isRequired});const p=ButtonLink},54205:(e,t,i)=>{i.d(t,{A:()=>m});var o=i(96540),r=i(5556),n=i.n(r),s=i(32485),a=i.n(s),l=i(1683),c=i(73725);const d="external-link-module__buttonVariant__AnYh7";var p=["eventName","eventTag","pageContext"];function ownKeys(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function _objectWithoutProperties(e,t){if(null==e)return{};var i,o,r=function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var i,o,r={},n=Object.keys(e);for(o=0;o<n.length;o++)i=n[o],t.indexOf(i)>=0||(r[i]=e[i]);return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)i=n[o],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function _defineProperty(e,t,i){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var h=c.A.createLogger("ClickMetrics","info"),u={BUTTON:"button",LINK:"link"};class ExternalLink extends o.Component{constructor(){super(...arguments),_defineProperty(this,"onClick",(e=>{var{metricOverrides:t={},name:i,onClick:o,shouldStopPropagation:r}=this.props,{metricContextName:n}=this.context,{eventName:s="clicked.".concat(i),eventTag:a=n,pageContext:c=this.context.pageContext}=t,d=_objectWithoutProperties(t,p);r&&e.stopPropagation(),h("ExternalLink ".concat(s,", eventTag: ").concat(a,", pageContext: ").concat(c)),l.A.log(s,function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(i),!0).forEach((function(t){_defineProperty(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ownKeys(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({eventTag:a},d),c),o&&o(e)}))}render(){var{className:e,name:t,href:i,target:r,type:n=u.LINK,children:s}=this.props;return o.createElement("a",{className:a()("external-link",e||t,{[d]:n===u.BUTTON}),onClick:this.onClick,href:i,target:r},s)}}_defineProperty(ExternalLink,"propTypes",{name:n().string.isRequired,href:n().string,onClick:n().func,shouldStopPropagation:n().bool,type:n().oneOf([u.LINK,u.BUTTON]),metricOverrides:n().shape({endTime:n().number,eventCount:n().number,eventName:n().string,eventTag:n().string,pageContext:n().string,startTime:n().number})}),_defineProperty(ExternalLink,"contextTypes",{pageContext:n().string.isRequired,metricContextName:n().string.isRequired});const m=ExternalLink},32098:(e,t,i)=>{i.d(t,{A:()=>f});var o=i(97200),r=i.n(o),n=i(60895),s=i.n(n),a=i(96540),l=i(5556),c=i.n(l),d=i(32485),p=i.n(d),h=i(84503),u=i(7138),m=i(20695);function _defineProperty(e,t,i){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var g="open";class ExpandableMenu extends((0,u.A)(a.Component)){constructor(e){super(e),_defineProperty(this,"closeTimeout",null),_defineProperty(this,"onToggleClick",(()=>{var{isOpen:e}=this.state,{disabled:t}=this.props;e?this.toggleMenu(!1,333):t||this.toggleMenu(!0,0)})),_defineProperty(this,"onWindowClick",(e=>{var{isOpen:t}=this.state,{target:i}=e,{navEl:o}=this;o&&i&&t&&i!==o&&!o.contains(i)&&this.toggleMenu(!1,333)})),_defineProperty(this,"onKeyDown",(e=>{var{isOpen:t}=this.state;if(t)return"Escape"===e.key?(this.toggleMenu(!1,333),void e.preventDefault()):void(this.menuRef.current&&(0,m.$G)(e,this.menuRef.current))})),this.state={isOpen:Boolean(e.isMenuOpenOnLoad)},this.menuRef=a.createRef(),this.triggerElement=null}componentWillUnmount(){clearTimeout(this.closeTimeout),window.removeEventListener("mousedown",this.onWindowClick)}componentDidMount(){var{isMenuOpenOnLoad:e}=this.props;e&&window.addEventListener("mousedown",this.onWindowClick)}componentDidUpdate(e,t){if(!t.isOpen&&this.state.isOpen){if(this.menuRef.current){var i=(0,m.gL)(this.menuRef.current);i.length>0?i[0].focus():(0,m.Ry)(this.menuRef.current)}}else t.isOpen&&!this.state.isOpen&&this.triggerElement&&"function"==typeof this.triggerElement.focus&&this.triggerElement.focus()}toggleMenu(e,t){e?window.addEventListener("mousedown",this.onWindowClick):window.removeEventListener("mousedown",this.onWindowClick),this.setState({isTransitioning:!0,isOpen:e}),clearTimeout(this.closeTimeout),this.closeTimeout=s()((()=>{var{onOpen:t,onClose:i}=this.props;e&&t?t():!e&&i&&i(),this.setState({isTransitioning:!1})}),t||0)}render(){var e,{closeOnClick:t=!0,position:i="center",alignment:o="bottom",children:n,metricOverrides:s,name:l,text:c,disabled:d,label:u}=this.props,{isOpen:m,isTransitioning:f}=this.state,v=p()("expandable-nav",this.props.className||l,{[g]:m&&!f}),y="menu-".concat(l||r()("expandable-menu"));(m||f)&&(e=a.createElement("nav",{ref:this.menuRef,onClick:t?this.onToggleClick:null,onKeyDown:this.onKeyDown,className:p()("expanded-nav",i,o),id:y,"aria-labelledby":"".concat(y,"-trigger")},n));var b=null!=u?u:"";return a.createElement("div",{className:v,ref:e=>{this.navEl=e}},a.createElement(h.A,{inputRef:e=>{this.triggerElement=e},label:b,onClick:this.onToggleClick,metricOverrides:s,name:l,className:"toggle",disabled:d,"aria-haspopup":"true","aria-expanded":m,"aria-controls":y,id:"".concat(y,"-trigger")},a.createElement("span",null,c)),e)}}_defineProperty(ExpandableMenu,"propTypes",{position:c().oneOf(["left","center","right"]),alignment:c().oneOf(["top","bottom"]),onOpen:c().func,onClose:c().func,isMenuOpenOnLoad:c().bool,text:c().oneOfType([c().string,c().node]),name:c().string.isRequired,disabled:c().bool,closeOnClick:c().bool,label:c().string});const f=ExpandableMenu},11354:(e,t,i)=>{i.d(t,{A:()=>h});var o=i(96540),r=i(5556),n=i.n(r),s=i(32485),a=i.n(s),l=i(32721),c=i(89873),d=i(21572),p=i(85796);function ownKeys(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(i),!0).forEach((function(t){_defineProperty(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ownKeys(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function _defineProperty(e,t,i){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class AlbumNode extends o.Component{constructor(){super(...arguments),_defineProperty(this,"state",{showSyncTooltip:!1}),_defineProperty(this,"onClick",(e=>{var{onClick:t,model:i}=this.props;null==t||t(e,i)})),_defineProperty(this,"onSyncIconEnter",(()=>this.setState({showSyncTooltip:!0}))),_defineProperty(this,"onSyncIconLeave",(()=>this.setState({showSyncTooltip:!1})))}render(){var{model:e,width:t,height:i,formatDate:r,className:n,style:s,children:h,additionalContent:u}=this.props;if(!e)return null;var m,g,f=e.getAlbumCovers(),v=e.name||(0,d.A)("amazon-photos-untitled-album-placeholder-name"),y=f.length>0?f[0]:null,b=a()("album-preview",y?"":"empty"),P=a()("album-title"),A=a()("node","album-node",n),{createdDate:C}=e.serviceProperties,w=C?new c.A(C).displayDate:"";r&&(w=r(e));var{showSyncTooltip:_}=this.state;e.isDynamicAlbum()&&(g=o.createElement(l.A,{text:(0,d.A)("amazon-photos-folder-album-synced"),active:_,className:"sync-tip"}),m=o.createElement("div",{className:"sync-icon",onMouseEnter:this.onSyncIconEnter,onMouseLeave:this.onSyncIconLeave}));var O=s;return(t||i)&&(O=_objectSpread(_objectSpread({},s),{},{width:t,height:i})),o.createElement("figure",{className:A,style:O},h,u,o.createElement("div",{className:"album-container"},o.createElement("div",{className:b},y&&o.createElement(p.A,{key:y.id,model:y})),o.createElement("div",{className:"details"},g,o.createElement("h5",{title:v,className:P},m,v),o.createElement("p",{title:w,className:"date-created"},w))))}}_defineProperty(AlbumNode,"propTypes",{model:n().shape({kind:n().oneOf(["VISUAL_COLLECTION"])}),formatDate:n().func});const h=AlbumNode},26645:(e,t,i)=>{i.d(t,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var o=i(96540);const __WEBPACK_DEFAULT_EXPORT__=()=>o.createElement("div",{className:"folder-preview"})},85796:(e,t,i)=>{i.d(t,{A:()=>N});var o=i(43346),r=i.n(o),n=i(19181),s=i.n(n),a=i(64112),l=i.n(a),c=i(63950),d=i.n(c),p=i(1882),h=i.n(p),u=i(96540),m=i(5556),g=i.n(m),f=i(13489),v=i(32485),y=i.n(v),b=i(61738),P=i(49479),A=i(77506),C=i(14697),w=i(51317),_=i(73725),O=i(40484),T=i(32359),E=i(87822),S=i(72924);function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},_extends.apply(this,arguments)}function _defineProperty(e,t,i){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var I="loading",x="loaded",k="error";class ImageNode extends u.Component{constructor(){super(...arguments),_defineProperty(this,"setSize",(()=>{var{width:e,height:t}=this.props,i=this.elImage;e&&t||!i||this.setState({width:i.clientWidth,height:i.clientHeight})})),_defineProperty(this,"onViewportChange",(e=>{e.width&&e.width!==this._lastViewportWidth&&(this.setSize(),this._lastViewportWidth=e.width)})),_defineProperty(this,"onImageStart",(()=>{this.notify("imageStart")})),_defineProperty(this,"onImageCancel",(()=>{this.notify("imageCancel")})),_defineProperty(this,"onLoad",((e,t)=>{var{model:i,onImageLoad:o,clip:r}=this.props,{width:n,height:s,src:a}=e.currentTarget,l=n*s;this.notify("imageLoaded",t),this.retryCount>0&&f.A.log({name:"ImageLoadRetry",value:this.retryCount}),l&&n&&s&&!r&&(0,T.xe)(i.id,a,l),this.setState({status:x}),o&&o(e)})),_defineProperty(this,"onRetry",(()=>{this.retryCount+=1})),_defineProperty(this,"onError",(e=>{var{model:t,onError:i,onImageError:o}=this.props;this.notify("imageError"),f.A.log({name:"ImageLoadFail"}),f.A.log({name:"ImageLoadRetry",value:2}),_.A.error("Failed to load image-node.",t.id),this.setState({status:k}),i?i(e,t):o&&o(e,t)})),this.retryCount=0,this.state={status:I}}UNSAFE_componentWillMount(){var{width:e,height:t,model:i}=this.props,{imageStatusListener:o}=this.context;e&&t||b.A.listen(this.onViewportChange,this),i||this.onError(),h()(o)||(this.notify=d())}componentDidMount(){var{model:e}=this.props;this.setSize(),e&&!e.hasThumbnail()&&this.setState({status:x})}componentWillUnmount(){b.A.unListen(this.onViewportChange,this),clearTimeout(this.asyncImageTimeout),this.notify("imageUnmount")}getThumbnailViewbox(e,t){var{model:i}=this.props,o=i.mediaContentProperties()||{};return(0,O.A)(e,t,o.width,o.height,1)}getMaximumDimensions(){var{height:e,width:t}=this.state,{model:i,width:o=t,height:r=e,thumbnail:n}=this.props,s=i.mediaContentProperties()||{};if(n||!s.width||!s.height)return{width:o,height:r};var{width:a,height:l}=s;return a<o&&l<r?{width:a,height:l}:(a>o&&(l*=o/a,a=o),l>r&&(a*=r/l,l=r),{width:a=Math.round(a),height:l=Math.round(l)})}getImagePreloadData(e){var{model:t,thumbnail:i}=this.props,o=(0,T.ZW)(t.id);if(o&&!i)return{placeholderImage:o,placeholderStyle:e}}getImageSource(e){var{width:t,height:i}=e,{clip:o,cropOffset:r,cropSize:n,fill:s,model:a={},thumbnail:l,zoom:c}=this.props,d=a.getContentUrlModel?a.getContentUrlModel():new w.A(a),p=b.A.getProperty("density",1);if("gif"===a.mediaProperties.mediaType&&(!l||a.filesize()<=1e6))return(0,E.y_)({nodeId:a.id,ownerId:a.ownerId,tempLink:a.tempLink});if(!t||!i)throw new Error("Need dimensions first");var h=t*p,u=i*p;c&&(h*=c/=100,u*=c),o&&d.setParam("fit","clip"),r&&d.setParam("cropOffset",r),n&&d.setParam("cropSize",n);var m="".concat(Math.round(h),",").concat(Math.round(u));l&&s&&(m=this.getThumbnailViewbox(h,u)),d.setParam("viewBox",m);var g=d.toString();return o||(g=(0,T.p)(a.id,g,h*u)),g}notify(e,t){var{imageStatusListener:i}=this.context,{model:o}=this.props,r=Date.now();l()((()=>i(e,o.id,this.elImage,r,t)))}render(){var e,t,{width:i,height:o,status:n}=this.state,{className:a,placeholder:l,model:c,width:d=i,height:p=o,style:h,children:m,thumbnail:g,onClick:f,transition:v,showLoading:b}=this.props;if(n===k||c&&!c.hasThumbnail())return u.createElement(S.A,_extends({},this.props,{imageLoadFailed:n===k}));if(f&&(f=s()(f,s().placeholder,c)),d&&p||(l=!0),!l){var P=this.getMaximumDimensions();t=this.getImagePreloadData(P),e=this.getImageSource(P)}return a=y()(a,"image-node",{placeholder:l,"image-loading":n===I,"image-loaded":n===x}),this.props.width&&this.props.height&&(h=r()({width:d,height:p},h)),u.createElement("figure",{style:h,ref:e=>{this.elImage=e},className:a,onClick:f},m,e&&u.createElement(C.A,_extends({},t,{retryLimit:2,onStart:this.onImageStart,onCancel:this.onImageCancel,onLoad:this.onLoad,onRetry:this.onRetry,onError:this.onError,src:e,transition:v,showLoading:b,useImageTag:!g})))}}_defineProperty(ImageNode,"contextTypes",{imageStatusListener:g().func}),_defineProperty(ImageNode,"propTypes",{className:g().string,clip:g().bool,cropOffset:g().string,cropSize:g().string,fill:g().bool,height:g().number,model:g().oneOfType([g().instanceOf(P.A),g().instanceOf(A.A)]).isRequired,onClick:g().func,onError:g().func,onImageError:g().func,onImageLoad:g().func,placeholder:g().bool,showLoading:g().bool,style:g().string,thumbnail:g().bool,transition:g().bool,width:g().number,zoom:g().number}),_defineProperty(ImageNode,"defaultProps",{fill:!0,thumbnail:!0});const N=ImageNode},88632:(e,t,i)=>{i.d(t,{A:()=>k});var o=i(96540),r=i(32485),n=i.n(r),s=i(73509),a=i(95093),l=i.n(a),c=i(5556),d=i.n(c),p=i(84503),h=i(35994),u=i(21572),m=i(73725),g=i(71086),f=i(37763),v=i(80286),y=i(85796),b=["children","isActive","model","videoId"],P=["children","className","isActive","model","videoId"];function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},_extends.apply(this,arguments)}function _objectWithoutProperties(e,t){if(null==e)return{};var i,o,r=function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var i,o,r={},n=Object.keys(e);for(o=0;o<n.length;o++)i=n[o],t.indexOf(i)>=0||(r[i]=e[i]);return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)i=n[o],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function _defineProperty(e,t,i){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class VideoNode extends o.Component{constructor(){super(...arguments),_defineProperty(this,"onPlayClick",(()=>this.playVideo())),_defineProperty(this,"onSpace",(()=>{var{isActive:e,videoId:t}=this.props;e&&!t&&this.playVideo()}))}componentDidMount(){var{thumbnail:e}=this.props;e||h.A.listen("space",this.onSpace,this)}componentWillUnmount(){var{thumbnail:e}=this.props;e||h.A.unListen("space",this.onSpace,this)}playVideo(){var{MAX_DURATION:e,MAX_SIZE:t}=VideoNode,{model:i}=this.props,{isPlayable:o}=i.mediaProperties;if(i.getDuration()>e)(0,f.A)((0,u.A)("amazon-photos-video-exceeds-length-body"),{name:"VideoTooLongError",heading:(0,u.A)("amazon-photos-video-exceeds-length-header"),buttons:["ok"]});else if(i.filesize()>t)(0,f.A)((0,u.A)("amazon-photos-video-exceeds-size-body"),{name:"VideoTooLargeError",heading:(0,u.A)("amazon-photos-video-exceeds-size-header"),buttons:["ok"]});else{if(!i.isVideoProcessing()||o)return o?void h.A.emit("playVideo",i.id):(m.A.error("Unable to play video","VideoNode.playVideo, nodeId=".concat(i.id)),void(0,f.A)((0,u.A)("cloud-drive-loading-failed-message"),{name:"VideoUnplayableError",heading:(0,u.A)("amazon-photos-error-fatal-header"),buttons:["ok"]}));(0,f.A)((0,u.A)("amazon-photos-video-processing-body"),{name:"VideoStillProcessingError",heading:(0,u.A)("amazon-photos-video-processing-header"),buttons:["ok"]})}}renderVideoDuration(){var{model:e}=this.props,t=e.getDuration();if(t){var i=l().duration(Math.round(t),"seconds"),r=i.days(),n=i.hours(),s=i.minutes(),a=i.seconds(),c=[];return r&&c.push(pad(r)),n&&c.push(pad(n)),c.push(pad(s)),c.push(pad(a)),c=c.join(":"),o.createElement("span",{className:"duration"},c)}function pad(e){return e<10?"0".concat(e):e}}renderVideoPlayer(e,t){var{isActive:i,model:r}=this.props;if(e||t){var n=r.getFormattedVideoUrl({width:e,height:t});return o.createElement("figure",{className:"video-container",style:{width:e,height:t}},o.createElement(v.A,{controls:!0,eventTag:"Video",autoplay:!0,isActive:i,model:r,loop:!1,src:n}))}}renderVideoPreviewImage(e,t){var i=this.props,{children:r,isActive:n,model:s,videoId:a}=i,l=_objectWithoutProperties(i,b),{isPlayable:c}=s.mediaProperties;return o.createElement("figure",{className:"video-preview-container",onClick:this.onPlayClick},o.createElement(y.A,_extends({},l,{className:"video-preview",height:t,model:s,width:e}),r,c&&this.renderVideoDuration(),o.createElement(p.A,{name:"play"})))}renderVideoThumbnail(){var e=this.props,{children:t,className:i,isActive:r,model:s,videoId:a}=e,l=_objectWithoutProperties(e,P),{isPlayable:c}=s.mediaProperties;return o.createElement(y.A,_extends({},l,{className:n()("video-node","video-thumbnail",i),model:s}),t,c&&this.renderVideoDuration(),o.createElement(p.A,{onClick:this.onPlayClick,name:"play"}))}render(){var{className:e,isActive:t,model:i,thumbnail:r,videoId:a}=this.props;if(r)return this.renderVideoThumbnail();var l=t&&a===i.id;return o.createElement("figure",{className:n()("video-node",e)},o.createElement("div",{className:"video-autosizer-wrapper"},o.createElement(s.t$,null,(e=>{var{width:t,height:i}=e;return l?this.renderVideoPlayer(t,i):this.renderVideoPreviewImage(t,i)}))))}}_defineProperty(VideoNode,"propTypes",{className:d().string,height:d().number,isActive:d().bool,model:(e,t)=>{if("VIDEO"!==e[t].getNodeType())return new Error("Invalid Prop ".concat(t," supplied to VideoNode"))},thumbnail:d().bool,width:d().number}),_defineProperty(VideoNode,"defaultProps",{model:{},thumbnail:!0}),_defineProperty(VideoNode,"MAX_DURATION",1200),_defineProperty(VideoNode,"MAX_SIZE",2147483648);const A=h.A.connect(VideoNode,[{store:g.A,mapToProps:["videoId"]}]);var C=i(11354),w=["isActive","videoId","videoPlaying"],_=["className","isActive","videoId","videoPlaying"];function live_photo_extends(){return live_photo_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},live_photo_extends.apply(this,arguments)}function live_photo_objectWithoutProperties(e,t){if(null==e)return{};var i,o,r=function live_photo_objectWithoutPropertiesLoose(e,t){if(null==e)return{};var i,o,r={},n=Object.keys(e);for(o=0;o<n.length;o++)i=n[o],t.indexOf(i)>=0||(r[i]=e[i]);return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)i=n[o],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function live_photo_defineProperty(e,t,i){return(t=function live_photo_toPropertyKey(e){var t=function live_photo_toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class LivePhotoNode extends o.Component{renderLivePhotoImage(e,t){var i=this.props,{isActive:r,videoId:n,videoPlaying:s}=i,a=live_photo_objectWithoutProperties(i,w);return o.createElement(y.A,live_photo_extends({},a,{className:"live-photo-image",height:t,width:e}))}renderLivePhotoThumbnail(){var e=this.props,{className:t,isActive:i,videoId:r,videoPlaying:s}=e,a=live_photo_objectWithoutProperties(e,_);return o.createElement(y.A,live_photo_extends({},a,{className:n()("live-photo-node",t)}))}renderLivePhotoVideoPlayer(e,t){var{isActive:i,model:r}=this.props;if(e||t){var n=r.getFormattedVideoUrl({width:e,height:t});return o.createElement("div",{className:"live-photo-video-container"},o.createElement(v.A,{controls:!1,eventTag:"LivePhoto",isActive:i,model:r,loop:!0,preload:"auto",restartOnPlay:!0,src:n}))}}render(){var{className:e,isActive:t,model:i,thumbnail:r,videoId:a,videoPlaying:l}=this.props;if(r)return this.renderLivePhotoThumbnail();var c=n()(e,"live-photo-node",{"live-photo-playing":!r&&t&&l&&i.id===a});return o.createElement("figure",{className:c},o.createElement("div",{className:"live-photo-autosizer-wrapper"},o.createElement(s.t$,null,(e=>{var{width:i,height:r}=e;return o.createElement("div",null,this.renderLivePhotoImage(i,r),t&&this.renderLivePhotoVideoPlayer(i,r))}))))}}live_photo_defineProperty(LivePhotoNode,"propTypes",{className:d().string,height:d().number,isActive:d().bool,model:(e,t)=>{if("LIVE_PHOTO"!==e[t].getNodeType())return new Error("Invalid Prop ".concat(t," supplied to LivePhotoNode"))},thumbnail:d().bool,width:d().number}),live_photo_defineProperty(LivePhotoNode,"defaultProps",{model:{},thumbnail:!0});const O=h.A.connect(LivePhotoNode,[{store:g.A,mapToProps:["videoId","videoPlaying"]}]);var T=i(26645);const E="share-link-module__linkPreview__RCQ38";const share_link=()=>o.createElement("div",{className:E});var S=i(72924),I=["placeholder","model","className"];function node_preview_extends(){return node_preview_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},node_preview_extends.apply(this,arguments)}function node_preview_objectWithoutProperties(e,t){if(null==e)return{};var i,o,r=function node_preview_objectWithoutPropertiesLoose(e,t){if(null==e)return{};var i,o,r={},n=Object.keys(e);for(o=0;o<n.length;o++)i=n[o],t.indexOf(i)>=0||(r[i]=e[i]);return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)i=n[o],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}var x={VIDEO:A,PHOTO:y.A,ALBUM:C.A,LIVE_PHOTO:O,FOLDER:T.A,SHARE:share_link};class NodePreview extends o.Component{getViewComponent(e){return x[e.getNodeType()]}render(){var e,t=this.props,{placeholder:i,model:r,className:s}=t,a=node_preview_objectWithoutProperties(t,I);return s=n()(s,"node"),r?e=this.getViewComponent(r)||S.A:(i=!0,e=S.A),o.createElement(e,node_preview_extends({},a,{placeholder:i,className:s,model:r}))}}const k=NodePreview},72924:(e,t,i)=>{i.d(t,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var o=i(43346),r=i.n(o),n=i(96540),s=i(32485),a=i.n(s),l=i(54351),c=i(73725);const __WEBPACK_DEFAULT_EXPORT__=e=>{var t,{style:i,width:o,height:s,placeholder:d,model:p,children:h,className:u,imageLoadFailed:m,shouldShowFileName:g=!0}=e,f=p&&p.getExtension(),v=p&&p.getMissingThumbnailReason(),y=!1;if(d)y=!0;else if(m)t=n.createElement("span",{className:"icon icon-broken"});else if(v)switch(v){case"video-processing":u=a()(u,"video-processing"),t=n.createElement(l.A,null,"video_processing");break;case"unsupported":y=!0;break;case"video-no-thumb":break;default:c.A.error("Invalid missing thumbnail reason ".concat(v,", nodeId ").concat(p.id),"UnpreviewableNode"),t=n.createElement("span",{className:"icon icon-broken"})}return y&&(t=f?".".concat(f.toUpperCase()):n.createElement("span",{className:"icon icon-file"})),(o||s)&&(i=r()({width:o,height:s},i)),n.createElement("figure",{style:i,className:a()(u,"unpreviewable")},n.createElement("span",null,h,t&&n.createElement("span",{className:"content"},t),p&&g&&n.createElement("span",{className:"filename",title:p.name},p.name)))}},94788:(e,t,i)=>{i.d(t,{A:()=>a});var o=i(5556),r=i.n(o),n=i(96540),s=i(21572),String=e=>{var{children:t,className:i,count:o,name:r,replace:a,style:l,title:c}=e;return n.createElement("span",{className:i,name:r,style:l,title:c},(0,s.A)(t,a,o))};String.propTypes={children:r().string.isRequired,className:r().string,count:r().number,name:r().string,replace:r().oneOfType([r().element,r().number,r().string,r().arrayOf(r().oneOfType([r().element,r().number,r().string]))]),style:r().string,title:r().string};const a=String},80286:(e,t,i)=>{i.d(t,{A:()=>A});var o=i(58156),r=i.n(o),n=i(1683),s=i(84503),a=i(32485),l=i.n(a),c=i(13489),d=i(21572),p=i(18742),h=i(96540),u=i(35994),m=i(89649),g=i(5556),f=i.n(g),v=i(71086),y=i(42341),b=i(94788),VideoOverlay=e=>{var{onReplay:t,onDownload:i}=e;return h.createElement("div",{className:"video-overlay"},h.createElement(s.A,{name:"replay",className:"replay-button",onClick:t,label:""}),h.createElement(s.A,{name:"download",className:"download-button",onClick:i},h.createElement(b.A,null,"amazon-photos-download")))};VideoOverlay.propTypes={onReplay:f().func.isRequired,onDownload:f().func.isRequired};const P=VideoOverlay;function _defineProperty(e,t,i){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class VideoPlayer extends h.Component{constructor(){super(...arguments),_defineProperty(this,"hasLoggedVideoPlayingHealthMetric",!1),_defineProperty(this,"state",{metadataReady:!1,hasError:!1,showOverlay:!1}),_defineProperty(this,"onClickedVideo",(e=>{var{controls:t,allowClickPropagation:i}=this.props;t?(0,m.A)(e,!1,!0):i||(0,m.A)(e)})),_defineProperty(this,"onClickedPlay",(()=>{this.playVideo()})),_defineProperty(this,"onDrag",(e=>{var{controls:t}=this.props;t&&(0,m.A)(e,!1,!0)})),_defineProperty(this,"onKeyDown",(e=>{32===e.keyCode&&(0,m.A)(e,!1,!0)})),_defineProperty(this,"onSpace",(()=>{var{isActive:e}=this.props;e&&this.toggleVideo()})),_defineProperty(this,"onEnded",(()=>{var{hasVideoOverlay:e}=this.props;this.logBizMetric("EndVideo"),u.A.emit("endVideo"),e&&(this.videoEl===document.fullscreenElement&&document.exitFullscreen(),this.videoEl.currentTime=0,this.setState({showOverlay:!0}))})),_defineProperty(this,"onReplay",(()=>{var{videoId:e}=this.props,{showOverlay:t}=this.state;t&&this.setState({showOverlay:!1}),this.logBizMetric("ReplayVideo"),u.A.emit("playVideo",e)})),_defineProperty(this,"onDownload",(()=>{var{model:e}=this.props,t=[e],i=v.A.getPageContext();this.logBizMetric("DownloadVideo"),(0,y.A)({models:t,pageContext:i})})),_defineProperty(this,"onError",(()=>{var{eventTag:e,isActive:t,model:i}=this.props;this.logBizMetric("VideoPlaybackError"),c.A.log({name:"VideoError",segments:{VideoType:e}}),u.A.emit("videoError",{model:i}),this.setState({hasError:!0}),t&&u.A.emit("showToast",{message:(0,d.A)("amazon-photos-web-video-play-failed-header"),className:"error video-player-error",content:h.createElement("div",{className:"additional-error-content"},(0,d.A)("amazon-photos-web-video-play-failed-message"))})})),_defineProperty(this,"onLoadedMetadata",(()=>{var{metadataReady:e}=this.state;e||this.setState({metadataReady:!0})})),_defineProperty(this,"onLoadStart",(e=>{var{eventTag:t,onLoadStart:i}=this.props;c.A.log({name:"VideoLoadStart",segments:{VideoType:t}}),i&&i(e)})),_defineProperty(this,"onCanPlayThrough",(()=>{var{videoPlaying:e}=this.props;e&&this.playVideo()})),_defineProperty(this,"onPause",(()=>{var{videoPlaying:e}=this.props;e&&u.A.emit("pauseVideo")})),_defineProperty(this,"onPlaying",(()=>{var{eventTag:e,model:t,videoPlaying:i}=this.props;this.logBizMetric("PlayVideo"),this.hasLoggedVideoPlayingHealthMetric||(this.hasLoggedVideoPlayingHealthMetric=!0,c.A.log({name:"VideoPlaying",segments:{VideoType:e}})),i||u.A.emit("playVideo",t.id)})),_defineProperty(this,"toggleVideo",(()=>{this.videoEl.paused?this.videoEl.play():this.videoEl.pause()}))}componentDidMount(){var{onMuteChange:e}=this.props;u.A.listen("space",this.onSpace,this),e&&this.videoEl.addEventListener("volumechange",(t=>e(t.target.muted)))}componentDidUpdate(e){var{model:t,restartOnPlay:i,videoId:o,videoPlaying:r,isInSlideshow:n,isActive:s}=this.props;!e.videoPlaying&&r&&t.id===o?(i&&(this.videoEl.currentTime=0),this.playVideo()):e.videoPlaying&&!r&&t.id===o&&this.pauseVideo(),n&&!s&&e.isActive&&(this.videoEl.currentTime=0)}componentWillUnmount(){this.pauseVideo(),u.A.unListen("space",this.onSpace,this),u.A.emit("stopVideo"),this.logBizMetric("EndVideo")}pauseVideo(){this.logBizMetric("PauseVideo"),this.videoEl.paused||this.videoEl.pause()}playVideo(){this.videoEl.paused&&this.videoEl.play()}logBizMetric(e){var{eventTag:t,mediaType:i,model:o}=this.props;n.A.log(e,{eventTag:t,fileDuration:r()(o,"mediaProperties.duration"),mediaType:i,sizeInBytes:r()(o,"mediaProperties.size")},v.A.getPageContext())}render(){var{autoplay:e,controls:t,device:i,loop:o,muted:r,preload:n,src:a,videoFormat:c,videoPlaying:d}=this.props,{metadataReady:p,hasError:u,showOverlay:m}=this.state,g=!p,f=l()("video-player",{loading:g},{"video-error":u}),v=l()("play",{"video-playing":d}),y=i.isMobile||i.isTablet;return h.createElement("section",{className:f},t&&!g&&!y&&h.createElement(s.A,{className:v,name:"play",onClick:this.onClickedPlay}),h.createElement("video",{controls:t,autoPlay:e,loop:o,muted:r,onCanPlayThrough:this.onCanPlayThrough,onClick:this.onClickedVideo,onEnded:this.onEnded,onError:this.onError,onKeyDown:this.onKeyDown,onLoadStart:this.onLoadStart,onLoadedMetadata:this.onLoadedMetadata,onMouseDown:this.onDrag,onPause:this.onPause,onPlaying:this.onPlaying,onTouchStart:this.onDrag,playsInline:e,preload:n,ref:e=>this.videoEl=e},h.createElement("source",{src:a,type:c})),m&&h.createElement(P,{onReplay:this.onReplay,onDownload:this.onDownload}))}}_defineProperty(VideoPlayer,"propTypes",{allowClickPropagation:f().bool,controls:f().bool,eventTag:f().string,isActive:f().bool,isInSlideshow:f().bool,loop:f().bool,mediaType:f().string,model:(e,t)=>{var i=e[t].getNodeType();if("VIDEO"!==i&&"LIVE_PHOTO"!==i)return new Error("Invalid Prop ".concat(t," supplied to VideoPlayer"))},onLoadStart:f().func,muted:f().bool,onMuteChange:f().func,preload:f().string,restartOnPlay:f().bool,src:f().string.isRequired,autoplay:f().bool,videoPlaying:f().bool,hasVideoOverlay:f().bool}),_defineProperty(VideoPlayer,"defaultProps",{controls:!0,eventTag:"Video",model:{},muted:!1,preload:"auto",mediaType:"video/mp4"});const A=u.A.connect(VideoPlayer,[{store:v.A,mapToProps:["videoId","videoPlaying","playClickTimerStart"]},{store:p.A,mapToProps:["device"]}])}}]);
//# sourceMappingURL=clouddrive-flux-adapters-dfd8bc3b799e2d6fc76a.js.map